2017-09-07 09:17:29,743 [MainThread  ] [INFO ]  (6293, 15)
2017-09-07 09:17:29,744 [MainThread  ] [INFO ]  (3101, 15)
2017-09-07 09:17:29,745 [MainThread  ] [INFO ]  testing complete...
2017-09-07 09:17:29,745 [MainThread  ] [INFO ]  Preprocess the train data with approach 2 and create various models
2017-09-07 09:17:29,841 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 09:17:29,871 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 09:17:29,916 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 09:17:29,983 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 09:17:30,000 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 09:17:30,016 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      6293   6293
unique      733      2
top     Drug024   TRUE
freq        197   4107
2017-09-07 09:17:40,748 [MainThread  ] [INFO ]  {4: 6011.0}
2017-09-07 09:17:43,607 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          6293   6293
unique          308      2
top          DSC016   TRUE
freq            422   4107
2017-09-07 09:17:46,277 [MainThread  ] [INFO ]  {4: 5560.0}
2017-09-07 09:17:46,448 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       6293   6293
unique       247      2
top        DC016   TRUE
freq         422   4107
2017-09-07 09:17:52,019 [MainThread  ] [INFO ]  {4: 5659.0}
2017-09-07 09:17:52,194 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              6293   6293
unique              485      2
top              DCN024   TRUE
freq                279   4107
2017-09-07 09:17:57,098 [MainThread  ] [INFO ]  {4: 5882.0}
2017-09-07 09:17:57,325 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      6293   6293
unique      965      2
top     DGPI025   TRUE
freq        185   4107
2017-09-07 09:18:05,019 [MainThread  ] [INFO ]  {4: 5960.0}
2017-09-07 09:18:05,187 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     6293   6293
unique    1578      2
top     NDC026   TRUE
freq       182   4107
2017-09-07 09:18:07,106 [MainThread  ] [INFO ]  {4: 6052.0}
2017-09-07 09:18:07,327 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       6293   6293
unique        77      2
top        DG004   TRUE
freq        1032   4107
2017-09-07 09:18:14,833 [MainThread  ] [INFO ]  {4: 4946.0}
2017-09-07 09:18:15,071 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       6293   6293
unique       834      2
top         G060   TRUE
freq         458   4107
2017-09-07 09:18:20,090 [MainThread  ] [INFO ]  {4: 5641.0}
2017-09-07 09:18:20,253 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   6293   6293
unique    96      2
top     B003   TRUE
freq    1300   4107
2017-09-07 09:18:23,497 [MainThread  ] [INFO ]  {4: 4429.0}
2017-09-07 09:18:23,687 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      6293   6293
unique      195      2
top     PCN0005   TRUE
freq       1026   4107
2017-09-07 09:18:29,045 [MainThread  ] [INFO ]  {4: 4929.0}
2017-09-07 09:18:29,214 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     6293   6293
unique      46      2
top     State2   TRUE
freq      1370   4107
2017-09-07 09:18:34,382 [MainThread  ] [INFO ]  {4: 3696.0}
2017-09-07 09:18:34,628 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn        ...          \
count       6293      6293  6293     6293        ...           
unique        77       834    96      195        ...           
top        DG004      G060  B003  PCN0005        ...           
freq        1032       458  1300     1026        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      6293                  6293   
unique                        4                     4   
top                           1                     1   
freq                       3705                  3845   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           6293             6293             6293   
unique                             4                4                4   
top                                0                1                2   
freq                            4122             3830             4107   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    6293                   6293             6293   
unique                      4                      4                4   
top                         1                      0                0   
freq                     3792                   3913             3734   

        pcn_cluster_num  state_cluster_num  
count              6293               6293  
unique                4                  4  
top                   1                  0  
freq               3769               2861  

[4 rows x 23 columns]
2017-09-07 09:18:34,662 [MainThread  ] [INFO ]          target  drug_cluster_num  drugsubclass_cluster_num  \
count     6293              6293                      6293   
unique       2                 4                         4   
top          1                 0                         1   
freq      4107              4187                      3705   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    6293                          6293             6293   
unique                      4                             4                4   
top                         1                             0                1   
freq                     3845                          4122             3830   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              6293                   6293                   6293   
unique                4                      4                      4   
top                   2                      1                      0   
freq               4107                   3792                   3913   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              6293             6293               6293  
unique                4                4                  4  
top                   0                1                  0  
freq               3734             3769               2861  
2017-09-07 09:18:34,684 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
4562                   1                   0                   0   
3365                   0                   1                   0   
2709                   1                   0                   0   
2357                   0                   1                   0   
6962                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
4562                   0                           0   
3365                   0                           1   
2709                   0                           0   
2357                   0                           1   
6962                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
4562                           1                           0   
3365                           0                           0   
2709                           1                           0   
2357                           0                           0   
6962                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
4562                           0                        0   
3365                           0                        1   
2709                           0                        0   
2357                           0                        1   
6962                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
4562                        1         ...                           0   
3365                        0         ...                           0   
2709                        1         ...                           0   
2357                        0         ...                           0   
6962                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
4562                  0                  0                  1   
3365                  1                  1                  0   
2709                  0                  0                  1   
2357                  0                  1                  0   
6962                  0                  0                  1   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
4562                  0                  0                    0   
3365                  0                  0                    0   
2709                  0                  0                    1   
2357                  0                  0                    0   
6962                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
4562                    0                    0                    1  
3365                    1                    0                    0  
2709                    0                    0                    0  
2357                    1                    0                    0  
6962                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 09:18:34,707 [MainThread  ] [INFO ]  Create Random Forest Model
2017-09-07 09:18:37,146 [MainThread  ] [INFO ]  Scores after performing cross validation :: [ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
2017-09-07 09:18:37,295 [MainThread  ] [INFO ]  describe y_pred_train before save :: [0 1]
2017-09-07 09:18:37,295 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 09:18:37,300 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 09:18:37,352 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 09:18:37,407 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 1.  0.  1. ...,  0.  1.  0.]
2017-09-07 09:18:37,408 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 09:18:37,733 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 09:18:37,862 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:18:37,862 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 09:18:38,409 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:18:38,409 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 09:18:38,620 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is train]=======================
2017-09-07 09:18:38,621 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:18:38,622 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:38,623 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:18:38,626 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:38,626 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:18:38,629 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:38,629 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:18:38,632 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:38,632 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:18:38,959 [MainThread  ] [INFO ]  Build Neural Net Model
2017-09-07 09:18:39,228 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 09:18:39,230 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 09:18:39,233 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 09:18:39,236 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.00000000e+00   1.64999426e-04   1.00000000e+00 ...,   1.64999426e-04
   9.99999992e-01   1.64999426e-04]
2017-09-07 09:18:39,601 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 09:18:39,731 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:18:39,731 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 09:18:40,078 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:18:40,078 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 09:18:40,273 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is train]=======================
2017-09-07 09:18:40,273 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:18:40,274 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:40,275 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:18:40,278 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:40,278 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:18:40,281 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:40,282 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:18:40,285 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:40,286 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:18:40,550 [MainThread  ] [INFO ]  Build SVM Model
2017-09-07 09:18:40,689 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 09:18:40,690 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 09:18:40,704 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 09:18:40,722 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99999910e-01   4.03394780e-04   9.99999919e-01 ...,   3.91931626e-04
   9.99998855e-01   4.03394780e-04]
2017-09-07 09:18:41,047 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 09:18:41,175 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:18:41,175 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 09:18:41,528 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:18:41,528 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 09:18:41,729 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is train]=======================
2017-09-07 09:18:41,729 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:18:41,731 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:41,731 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:18:41,735 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:41,736 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:18:41,744 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:41,744 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:18:41,748 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:41,749 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:18:42,082 [MainThread  ] [INFO ]  Build Naives Bayes Model
2017-09-07 09:18:42,090 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 09:18:42,091 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 09:18:42,095 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 09:18:42,100 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.00000000e+00   2.84532461e-35   1.00000000e+00 ...,   6.83910224e-36
   1.00000000e+00   2.84532461e-35]
2017-09-07 09:18:42,458 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 09:18:42,589 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:18:42,589 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 09:18:42,931 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:18:42,931 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 09:18:43,132 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is train]=======================
2017-09-07 09:18:43,132 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:18:43,134 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:43,134 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:18:43,138 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:43,138 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:18:43,142 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:43,142 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:18:43,147 [MainThread  ] [INFO ]  1.0
2017-09-07 09:18:43,147 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:18:43,412 [MainThread  ] [INFO ]  training complete...
2017-09-07 09:18:43,412 [MainThread  ] [INFO ]  evaluate the models on the test data
2017-09-07 09:18:43,454 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 09:18:43,470 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 09:18:43,487 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 09:18:43,530 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 09:18:43,544 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 09:18:43,558 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      3101   3101
unique      630      3
top     Drug019   TRUE
freq        118   2068
2017-09-07 09:18:45,167 [MainThread  ] [INFO ]  {4: 2956.0}
2017-09-07 09:18:45,324 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          3101   3101
unique          281      3
top          DSC016   TRUE
freq            194   2068
2017-09-07 09:18:47,938 [MainThread  ] [INFO ]  {4: 2820.0}
2017-09-07 09:18:48,091 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       3101   3101
unique       229      3
top        DC016   TRUE
freq         194   2068
2017-09-07 09:18:49,606 [MainThread  ] [INFO ]  {4: 2765.0}
2017-09-07 09:18:49,752 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              3101   3101
unique              430      3
top              DCN024   TRUE
freq                142   2068
2017-09-07 09:18:54,539 [MainThread  ] [INFO ]  {4: 2863.0}
2017-09-07 09:18:54,692 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      3101   3101
unique      814      3
top     DGPI025   TRUE
freq         92   2068
2017-09-07 09:18:56,065 [MainThread  ] [INFO ]  {4: 2963.0}
2017-09-07 09:18:56,217 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     3101   3101
unique    1281      3
top     NDC026   TRUE
freq        89   2068
2017-09-07 09:18:57,633 [MainThread  ] [INFO ]  {4: 2992.0}
2017-09-07 09:18:57,870 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       3101   3101
unique        78      3
top        DG004   TRUE
freq         516   2068
2017-09-07 09:18:59,001 [MainThread  ] [INFO ]  {4: 2533.0}
2017-09-07 09:18:59,151 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       3101   3101
unique       693      3
top         G060   TRUE
freq         219   2068
2017-09-07 09:19:00,261 [MainThread  ] [INFO ]  {4: 2763.0}
2017-09-07 09:19:00,407 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   3101   3101
unique    94      3
top     B003   TRUE
freq     627   2068
2017-09-07 09:19:01,376 [MainThread  ] [INFO ]  {4: 2145.0}
2017-09-07 09:19:01,520 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      3101   3101
unique      178      3
top     PCN0005   TRUE
freq        539   2068
2017-09-07 09:19:02,861 [MainThread  ] [INFO ]  {4: 2345.0}
2017-09-07 09:19:03,004 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     3101   3101
unique      48      3
top     State2   TRUE
freq       659   2068
2017-09-07 09:19:04,824 [MainThread  ] [INFO ]  {4: 2089.0}
2017-09-07 09:19:05,047 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn        ...          \
count       3101      3101  3101     3101        ...           
unique        78       693    94      178        ...           
top        DG004      G060  B003  PCN0005        ...           
freq         516       219   627      539        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      3101                  3101   
unique                        4                     4   
top                           1                     0   
freq                       2015                  2030   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           3101             3101             3101   
unique                             4                4                4   
top                                0                0                0   
freq                            2055             2073             2048   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    3101                   3101             3101   
unique                      4                      4                4   
top                         0                      0                0   
freq                     2016                   1949             1488   

        pcn_cluster_num  state_cluster_num  
count              3101               3101  
unique                4                  4  
top                   0                  0  
freq               1757               1819  

[4 rows x 23 columns]
2017-09-07 09:19:05,089 [MainThread  ] [INFO ]  test data pre-processed describe ::         target  drug_cluster_num  drugsubclass_cluster_num  \
count     3101              3101                      3101   
unique       2                 4                         4   
top          1                 0                         1   
freq      2068              2102                      2015   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    3101                          3101             3101   
unique                      4                             4                4   
top                         0                             0                0   
freq                     2030                          2055             2073   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              3101                   3101                   3101   
unique                4                      4                      4   
top                   0                      0                      0   
freq               2048                   2016                   1949   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              3101             3101               3101  
unique                4                4                  4  
top                   0                0                  0  
freq               1488             1757               1819  
2017-09-07 09:19:05,101 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           1                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        0   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  1                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  1                    0   
1731                  0                  1                    0   
6423                  0                  0                    1   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    0                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 09:19:05,121 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 09:19:05,122 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 09:19:05,124 [MainThread  ] [INFO ]  y_pred is :: [0 0 1 ..., 1 1 0]
2017-09-07 09:19:05,126 [MainThread  ] [INFO ]  y_pred probabilities is :: [  3.07777655e-06   7.86361327e-05   9.98073730e-01 ...,   5.12116449e-01
   9.99999871e-01   9.51106246e-02]
2017-09-07 09:19:05,472 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 774  259]
 [ 652 1416]]
2017-09-07 09:19:05,599 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:19:05,600 [MainThread  ] [INFO ]  [[ 774  259]
 [ 652 1416]]
2017-09-07 09:19:05,938 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:19:05,938 [MainThread  ] [INFO ]  [[ 0.74927396  0.25072604]
 [ 0.31528046  0.68471954]]
2017-09-07 09:19:06,130 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is test]=======================
2017-09-07 09:19:06,131 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:19:06,132 [MainThread  ] [INFO ]  0.706223798775
2017-09-07 09:19:06,132 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:19:06,134 [MainThread  ] [INFO ]  0.684719535783
2017-09-07 09:19:06,135 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:19:06,136 [MainThread  ] [INFO ]  0.845373134328
2017-09-07 09:19:06,137 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:19:06,139 [MainThread  ] [INFO ]  0.75661234304
2017-09-07 09:19:06,140 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:19:06,422 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           1                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        0   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  1                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  1                    0   
1731                  0                  1                    0   
6423                  0                  0                    1   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    0                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 09:19:06,445 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 09:19:06,451 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 09:19:06,480 [MainThread  ] [INFO ]  y_pred is :: [0 1 1 ..., 0 1 0]
2017-09-07 09:19:06,508 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.44  0.59  0.61 ...,  0.34  0.59  0.34]
2017-09-07 09:19:06,863 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[  73  960]
 [1648  420]]
2017-09-07 09:19:06,991 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:19:06,991 [MainThread  ] [INFO ]  [[  73  960]
 [1648  420]]
2017-09-07 09:19:07,429 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:19:07,429 [MainThread  ] [INFO ]  [[ 0.07066796  0.92933204]
 [ 0.79690522  0.20309478]]
2017-09-07 09:19:07,701 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is test]=======================
2017-09-07 09:19:07,701 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:19:07,703 [MainThread  ] [INFO ]  0.158980973879
2017-09-07 09:19:07,703 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:19:07,706 [MainThread  ] [INFO ]  0.203094777563
2017-09-07 09:19:07,706 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:19:07,708 [MainThread  ] [INFO ]  0.304347826087
2017-09-07 09:19:07,708 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:19:07,711 [MainThread  ] [INFO ]  0.243619489559
2017-09-07 09:19:07,711 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:19:08,034 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           1                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        0   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  1                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  1                    0   
1731                  0                  1                    0   
6423                  0                  0                    1   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    0                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 09:19:08,058 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 09:19:08,060 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 09:19:08,105 [MainThread  ] [INFO ]  y_pred is :: [0 0 0 ..., 1 1 0]
2017-09-07 09:19:08,107 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.07646745e-03   8.20075896e-04   4.96168601e-02 ...,   8.76658742e-01
   9.54985396e-01   2.78155826e-01]
2017-09-07 09:19:08,460 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[1008   25]
 [ 686 1382]]
2017-09-07 09:19:08,601 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:19:08,602 [MainThread  ] [INFO ]  [[1008   25]
 [ 686 1382]]
2017-09-07 09:19:08,946 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:19:08,947 [MainThread  ] [INFO ]  [[ 0.97579864  0.02420136]
 [ 0.33172147  0.66827853]]
2017-09-07 09:19:09,137 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is test]=======================
2017-09-07 09:19:09,137 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:19:09,139 [MainThread  ] [INFO ]  0.770719122864
2017-09-07 09:19:09,139 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:19:09,142 [MainThread  ] [INFO ]  0.668278529981
2017-09-07 09:19:09,142 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:19:09,144 [MainThread  ] [INFO ]  0.98223169865
2017-09-07 09:19:09,145 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:19:09,146 [MainThread  ] [INFO ]  0.795395683453
2017-09-07 09:19:09,147 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:19:09,423 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           1                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        0   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  1                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  1                    0   
1731                  0                  1                    0   
6423                  0                  0                    1   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    0                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 09:19:09,451 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 09:19:09,452 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 09:19:09,458 [MainThread  ] [INFO ]  y_pred is :: [0 0 1 ..., 0 1 0]
2017-09-07 09:19:09,467 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.29239968  0.52695117  0.7870813  ...,  0.53050895  0.85417571  0.5       ]
2017-09-07 09:19:09,801 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 707  326]
 [1429  639]]
2017-09-07 09:19:09,932 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 09:19:09,932 [MainThread  ] [INFO ]  [[ 707  326]
 [1429  639]]
2017-09-07 09:19:10,371 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 09:19:10,371 [MainThread  ] [INFO ]  [[ 0.68441433  0.31558567]
 [ 0.6910058   0.3089942 ]]
2017-09-07 09:19:10,573 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is test]=======================
2017-09-07 09:19:10,573 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 09:19:10,574 [MainThread  ] [INFO ]  0.434053531119
2017-09-07 09:19:10,574 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 09:19:10,577 [MainThread  ] [INFO ]  0.308994197292
2017-09-07 09:19:10,577 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 09:19:10,579 [MainThread  ] [INFO ]  0.662176165803
2017-09-07 09:19:10,580 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 09:19:10,583 [MainThread  ] [INFO ]  0.421364985163
2017-09-07 09:19:10,583 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 09:19:10,836 [MainThread  ] [INFO ]  testing complete...
2017-09-07 10:24:21,521 [MainThread  ] [INFO ]  (6293, 15)
2017-09-07 10:24:21,522 [MainThread  ] [INFO ]  (3101, 15)
2017-09-07 10:24:21,522 [MainThread  ] [INFO ]  testing complete...
2017-09-07 10:24:21,522 [MainThread  ] [INFO ]  Preprocess the train data with approach 2 and create various models
2017-09-07 10:24:21,577 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 10:24:21,592 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 10:24:21,620 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 10:24:21,675 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 10:24:21,689 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 10:24:21,704 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      6293   6293
unique      733      2
top     Drug024   TRUE
freq        197   4107
2017-09-07 10:24:30,930 [MainThread  ] [INFO ]  {4: 5915.0}
2017-09-07 10:24:31,354 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          6293   6293
unique          308      2
top          DSC016   TRUE
freq            422   4107
2017-09-07 10:24:39,182 [MainThread  ] [INFO ]  {4: 5576.0}
2017-09-07 10:24:39,343 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       6293   6293
unique       247      2
top        DC016   TRUE
freq         422   4107
2017-09-07 10:24:51,329 [MainThread  ] [INFO ]  {4: 5553.0}
2017-09-07 10:24:51,530 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              6293   6293
unique              485      2
top              DCN024   TRUE
freq                279   4107
2017-09-07 10:24:59,635 [MainThread  ] [INFO ]  {4: 5895.0}
2017-09-07 10:24:59,872 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      6293   6293
unique      965      2
top     DGPI025   TRUE
freq        185   4107
2017-09-07 10:25:02,629 [MainThread  ] [INFO ]  {4: 6045.0}
2017-09-07 10:25:02,783 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     6293   6293
unique    1578      2
top     NDC026   TRUE
freq       182   4107
2017-09-07 10:25:05,255 [MainThread  ] [INFO ]  {4: 6072.0}
2017-09-07 10:25:05,459 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       6293   6293
unique        77      2
top        DG004   TRUE
freq        1032   4107
2017-09-07 10:25:10,750 [MainThread  ] [INFO ]  {4: 4945.0}
2017-09-07 10:25:10,910 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       6293   6293
unique       834      2
top         G060   TRUE
freq         458   4107
2017-09-07 10:25:16,148 [MainThread  ] [INFO ]  {4: 5620.0}
2017-09-07 10:25:16,299 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   6293   6293
unique    96      2
top     B003   TRUE
freq    1300   4107
2017-09-07 10:25:20,221 [MainThread  ] [INFO ]  {4: 4436.0}
2017-09-07 10:25:20,404 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      6293   6293
unique      195      2
top     PCN0005   TRUE
freq       1026   4107
2017-09-07 10:25:24,412 [MainThread  ] [INFO ]  {4: 4377.0}
2017-09-07 10:25:24,566 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     6293   6293
unique      46      2
top     State2   TRUE
freq      1370   4107
2017-09-07 10:25:32,936 [MainThread  ] [INFO ]  {4: 3930.0}
2017-09-07 10:25:33,191 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn        ...          \
count       6293      6293  6293     6293        ...           
unique        77       834    96      195        ...           
top        DG004      G060  B003  PCN0005        ...           
freq        1032       458  1300     1026        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      6293                  6293   
unique                        4                     4   
top                           1                     0   
freq                       3721                  3979   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           6293             6293             6293   
unique                             4                4                4   
top                                1                0                0   
freq                            3886             4115             4068   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    6293                   6293             6293   
unique                      4                      4                4   
top                         0                      0                1   
freq                     3644                   3811             3550   

        pcn_cluster_num  state_cluster_num  
count              6293               6293  
unique                4                  4  
top                   0                  0  
freq               3184               3336  

[4 rows x 23 columns]
2017-09-07 10:25:33,229 [MainThread  ] [INFO ]          target  drug_cluster_num  drugsubclass_cluster_num  \
count     6293              6293                      6293   
unique       2                 4                         4   
top          1                 2                         1   
freq      4107              4034                      3721   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    6293                          6293             6293   
unique                      4                             4                4   
top                         0                             1                0   
freq                     3979                          3886             4115   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              6293                   6293                   6293   
unique                4                      4                      4   
top                   0                      0                      0   
freq               4068                   3644                   3811   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              6293             6293               6293  
unique                4                4                  4  
top                   1                0                  0  
freq               3550             3184               3336  
2017-09-07 10:25:33,251 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
4562                   0                   0                   1   
3365                   1                   0                   0   
2709                   0                   0                   1   
2357                   1                   0                   0   
6962                   0                   0                   1   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
4562                   0                           0   
3365                   0                           1   
2709                   0                           0   
2357                   0                           1   
6962                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
4562                           1                           0   
3365                           0                           0   
2709                           1                           0   
2357                           0                           0   
6962                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
4562                           0                        1   
3365                           0                        0   
2709                           0                        1   
2357                           0                        0   
6962                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
4562                        0         ...                           0   
3365                        0         ...                           0   
2709                        0         ...                           0   
2357                        0         ...                           0   
6962                        0         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
4562                  0                  1                  0   
3365                  0                  0                  1   
2709                  0                  1                  0   
2357                  0                  0                  1   
6962                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
4562                  0                  0                    0   
3365                  0                  0                    0   
2709                  0                  0                    1   
2357                  0                  0                    0   
6962                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
4562                    0                    1                    0  
3365                    1                    0                    0  
2709                    0                    0                    0  
2357                    1                    0                    0  
6962                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:25:33,273 [MainThread  ] [INFO ]  Create Random Forest Model
2017-09-07 10:25:35,880 [MainThread  ] [INFO ]  Scores after performing cross validation :: [ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
2017-09-07 10:25:35,885 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 10:25:35,891 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 10:25:35,942 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:25:35,994 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 1.  0.  1. ...,  0.  1.  0.]
2017-09-07 10:25:35,995 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 10:25:36,328 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:25:36,464 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:25:36,464 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:25:36,820 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:25:36,820 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:25:37,031 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is train]=======================
2017-09-07 10:25:37,031 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:25:37,033 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:37,033 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:25:37,036 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:37,036 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:25:37,040 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:37,040 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:25:37,043 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:37,044 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:25:37,354 [MainThread  ] [INFO ]  Build Neural Net Model
2017-09-07 10:25:37,472 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 10:25:37,473 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 10:25:37,476 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:25:37,479 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.00000000e+00   2.34889904e-04   1.00000000e+00 ...,   2.34889904e-04
   1.00000000e+00   2.34889904e-04]
2017-09-07 10:25:37,835 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:25:37,978 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:25:37,978 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:25:38,333 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:25:38,333 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:25:38,534 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is train]=======================
2017-09-07 10:25:38,534 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:25:38,536 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:38,536 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:25:38,541 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:38,541 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:25:38,545 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:38,546 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:25:38,549 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:38,549 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:25:38,796 [MainThread  ] [INFO ]  Build SVM Model
2017-09-07 10:25:38,979 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 10:25:38,981 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 10:25:39,000 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:25:39,025 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99999875e-01   2.68107288e-04   9.99999882e-01 ...,   2.68107288e-04
   9.99999756e-01   4.01148886e-04]
2017-09-07 10:25:39,348 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:25:39,490 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:25:39,490 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:25:39,833 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:25:39,833 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:25:40,036 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is train]=======================
2017-09-07 10:25:40,037 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:25:40,038 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:40,039 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:25:40,043 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:40,043 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:25:40,046 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:40,047 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:25:40,051 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:40,052 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:25:40,395 [MainThread  ] [INFO ]  Build Naives Bayes Model
2017-09-07 10:25:40,404 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 10:25:40,405 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 10:25:40,408 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:25:40,412 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.00000000e+00   6.62175455e-38   1.00000000e+00 ...,   6.62175455e-38
   1.00000000e+00   9.48574109e-34]
2017-09-07 10:25:40,756 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:25:40,901 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:25:40,901 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:25:41,260 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:25:41,261 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:25:41,467 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is train]=======================
2017-09-07 10:25:41,468 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:25:41,470 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:41,470 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:25:41,473 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:41,474 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:25:41,476 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:41,477 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:25:41,479 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:41,480 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:25:41,724 [MainThread  ] [INFO ]  Build Gradient Boosting Model
2017-09-07 10:25:45,750 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/gbm.sav
2017-09-07 10:25:45,795 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 10:25:45,852 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:25:45,908 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99773311e-01   4.26616484e-04   9.99773311e-01 ...,   4.26616484e-04
   9.99773311e-01   4.26616484e-04]
2017-09-07 10:25:45,909 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 10:25:46,243 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:25:46,395 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:25:46,395 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:25:46,817 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:25:46,817 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:25:47,041 [MainThread  ] [INFO ]  ================ Evaluation metrics for model gbm [Dataset is train]=======================
2017-09-07 10:25:47,042 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:25:47,043 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:47,043 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:25:47,047 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:47,047 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:25:47,050 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:47,050 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:25:47,053 [MainThread  ] [INFO ]  1.0
2017-09-07 10:25:47,053 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:25:47,295 [MainThread  ] [INFO ]  training complete...
2017-09-07 10:25:47,295 [MainThread  ] [INFO ]  evaluate the models on the test data
2017-09-07 10:25:47,389 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 10:25:47,419 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 10:25:47,491 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 10:25:47,590 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 10:25:47,619 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 10:25:47,637 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      3101   3101
unique      630      3
top     Drug019   TRUE
freq        118   2068
2017-09-07 10:25:49,245 [MainThread  ] [INFO ]  {4: 2963.0}
2017-09-07 10:25:49,429 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          3101   3101
unique          281      3
top          DSC016   TRUE
freq            194   2068
2017-09-07 10:25:54,213 [MainThread  ] [INFO ]  {4: 2741.0}
2017-09-07 10:25:54,371 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       3101   3101
unique       229      3
top        DC016   TRUE
freq         194   2068
2017-09-07 10:25:55,860 [MainThread  ] [INFO ]  {4: 2744.0}
2017-09-07 10:25:56,035 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              3101   3101
unique              430      3
top              DCN024   TRUE
freq                142   2068
2017-09-07 10:25:57,241 [MainThread  ] [INFO ]  {4: 2882.0}
2017-09-07 10:25:57,405 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      3101   3101
unique      814      3
top     DGPI025   TRUE
freq         92   2068
2017-09-07 10:26:00,253 [MainThread  ] [INFO ]  {4: 2950.0}
2017-09-07 10:26:00,409 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     3101   3101
unique    1281      3
top     NDC026   TRUE
freq        89   2068
2017-09-07 10:26:01,392 [MainThread  ] [INFO ]  {4: 3007.0}
2017-09-07 10:26:01,552 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       3101   3101
unique        78      3
top        DG004   TRUE
freq         516   2068
2017-09-07 10:26:03,104 [MainThread  ] [INFO ]  {4: 2420.0}
2017-09-07 10:26:03,259 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       3101   3101
unique       693      3
top         G060   TRUE
freq         219   2068
2017-09-07 10:26:05,477 [MainThread  ] [INFO ]  {4: 2703.0}
2017-09-07 10:26:05,731 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   3101   3101
unique    94      3
top     B003   TRUE
freq     627   2068
2017-09-07 10:26:06,787 [MainThread  ] [INFO ]  {4: 2145.0}
2017-09-07 10:26:06,939 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      3101   3101
unique      178      3
top     PCN0005   TRUE
freq        539   2068
2017-09-07 10:26:08,336 [MainThread  ] [INFO ]  {4: 2130.0}
2017-09-07 10:26:08,492 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     3101   3101
unique      48      3
top     State2   TRUE
freq       659   2068
2017-09-07 10:26:09,986 [MainThread  ] [INFO ]  {4: 1826.0}
2017-09-07 10:26:10,232 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn        ...          \
count       3101      3101  3101     3101        ...           
unique        78       693    94      178        ...           
top        DG004      G060  B003  PCN0005        ...           
freq         516       219   627      539        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      3101                  3101   
unique                        4                     4   
top                           1                     0   
freq                       1811                  2009   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           3101             3101             3101   
unique                             4                4                4   
top                                0                1                0   
freq                            2074             2044             2068   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    3101                   3101             3101   
unique                      4                      4                4   
top                         1                      1                0   
freq                     1890                   1788             1587   

        pcn_cluster_num  state_cluster_num  
count              3101               3101  
unique                4                  4  
top                   0                  0  
freq               1636               1452  

[4 rows x 23 columns]
2017-09-07 10:26:10,269 [MainThread  ] [INFO ]  test data pre-processed describe ::         target  drug_cluster_num  drugsubclass_cluster_num  \
count     3101              3101                      3101   
unique       2                 4                         4   
top          1                 1                         1   
freq      2068              2016                      1811   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    3101                          3101             3101   
unique                      4                             4                4   
top                         0                             0                1   
freq                     2009                          2074             2044   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              3101                   3101                   3101   
unique                4                      4                      4   
top                   0                      1                      1   
freq               2068                   1890                   1788   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              3101             3101               3101  
unique                4                4                  4  
top                   0                0                  0  
freq               1587             1636               1452  
2017-09-07 10:26:10,287 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   1                   0                   0   
1731                   1                   0                   0   
6423                   0                   1                   0   
8706                   0                   1                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           0                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           1                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           0   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    0   
8295                  1                  0                    0   
1731                  1                  0                    0   
6423                  0                  1                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    1  
1731                    0                    0                    1  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:26:10,309 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 10:26:10,309 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 10:26:10,311 [MainThread  ] [INFO ]  y_pred is :: [0 1 1 ..., 0 1 0]
2017-09-07 10:26:10,312 [MainThread  ] [INFO ]  y_pred probabilities is :: [  7.18183440e-11   9.99997537e-01   9.99997537e-01 ...,   2.54776147e-03
   9.99109313e-01   6.86390612e-02]
2017-09-07 10:26:10,692 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 333  700]
 [1327  741]]
2017-09-07 10:26:10,831 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:26:10,831 [MainThread  ] [INFO ]  [[ 333  700]
 [1327  741]]
2017-09-07 10:26:11,196 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:26:11,197 [MainThread  ] [INFO ]  [[ 0.32236205  0.67763795]
 [ 0.64168279  0.35831721]]
2017-09-07 10:26:11,404 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is test]=======================
2017-09-07 10:26:11,404 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:26:11,406 [MainThread  ] [INFO ]  0.346339890358
2017-09-07 10:26:11,406 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:26:11,409 [MainThread  ] [INFO ]  0.3583172147
2017-09-07 10:26:11,410 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:26:11,412 [MainThread  ] [INFO ]  0.514226231783
2017-09-07 10:26:11,412 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:26:11,415 [MainThread  ] [INFO ]  0.422342547734
2017-09-07 10:26:11,415 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:26:11,673 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   1                   0                   0   
1731                   1                   0                   0   
6423                   0                   1                   0   
8706                   0                   1                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           0                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           1                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           0   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    0   
8295                  1                  0                    0   
1731                  1                  0                    0   
6423                  0                  1                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    1  
1731                    0                    0                    1  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:26:11,696 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 10:26:11,703 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 10:26:11,733 [MainThread  ] [INFO ]  y_pred is :: [1 0 0 ..., 1 1 1]
2017-09-07 10:26:11,761 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.54  0.42  0.42 ...,  0.65  0.78  0.67]
2017-09-07 10:26:12,085 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[1021   12]
 [  45 2023]]
2017-09-07 10:26:12,273 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:26:12,274 [MainThread  ] [INFO ]  [[1021   12]
 [  45 2023]]
2017-09-07 10:26:12,618 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:26:12,618 [MainThread  ] [INFO ]  [[ 0.98838335  0.01161665]
 [ 0.02176015  0.97823985]]
2017-09-07 10:26:12,903 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is test]=======================
2017-09-07 10:26:12,903 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:26:12,904 [MainThread  ] [INFO ]  0.981618832635
2017-09-07 10:26:12,904 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:26:12,906 [MainThread  ] [INFO ]  0.978239845261
2017-09-07 10:26:12,906 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:26:12,908 [MainThread  ] [INFO ]  0.994103194103
2017-09-07 10:26:12,908 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:26:12,910 [MainThread  ] [INFO ]  0.986107726054
2017-09-07 10:26:12,910 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:26:13,160 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   1                   0                   0   
1731                   1                   0                   0   
6423                   0                   1                   0   
8706                   0                   1                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           0                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           1                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           0   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    0   
8295                  1                  0                    0   
1731                  1                  0                    0   
6423                  0                  1                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    1  
1731                    0                    0                    1  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:26:13,185 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 10:26:13,186 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 10:26:13,211 [MainThread  ] [INFO ]  y_pred is :: [1 1 1 ..., 1 1 1]
2017-09-07 10:26:13,214 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 1.  1.  1. ...,  1.  1.  1.]
2017-09-07 10:26:13,569 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   6 1027]
 [   2 2066]]
2017-09-07 10:26:13,712 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:26:13,713 [MainThread  ] [INFO ]  [[   6 1027]
 [   2 2066]]
2017-09-07 10:26:14,056 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:26:14,056 [MainThread  ] [INFO ]  [[  5.80832527e-03   9.94191675e-01]
 [  9.67117988e-04   9.99032882e-01]]
2017-09-07 10:26:14,251 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is test]=======================
2017-09-07 10:26:14,251 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:26:14,252 [MainThread  ] [INFO ]  0.668171557562
2017-09-07 10:26:14,252 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:26:14,255 [MainThread  ] [INFO ]  0.999032882012
2017-09-07 10:26:14,255 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:26:14,257 [MainThread  ] [INFO ]  0.667959909473
2017-09-07 10:26:14,258 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:26:14,260 [MainThread  ] [INFO ]  0.800620034877
2017-09-07 10:26:14,261 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:26:14,521 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   0                   0                   0   
8295                   1                   0                   0   
1731                   1                   0                   0   
6423                   0                   1                   0   
8706                   0                   1                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   1                           0   
8295                   0                           1   
1731                   0                           1   
6423                   0                           0   
8706                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           0   
1731                           0                           0   
6423                           0                           0   
8706                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           1                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           0   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  0   
1731                  0                  0                  0   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    0   
8295                  1                  0                    0   
1731                  1                  0                    0   
6423                  0                  1                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    1  
1731                    0                    0                    1  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:26:14,542 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 10:26:14,543 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 10:26:14,553 [MainThread  ] [INFO ]  y_pred is :: [0 1 1 ..., 1 1 1]
2017-09-07 10:26:14,566 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.50880872  0.79623151  0.79623151 ...,  0.71847255  0.9463659
  0.87286941]
2017-09-07 10:26:14,891 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 235  798]
 [ 111 1957]]
2017-09-07 10:26:15,032 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:26:15,032 [MainThread  ] [INFO ]  [[ 235  798]
 [ 111 1957]]
2017-09-07 10:26:15,383 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:26:15,384 [MainThread  ] [INFO ]  [[ 0.22749274  0.77250726]
 [ 0.05367505  0.94632495]]
2017-09-07 10:26:15,703 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is test]=======================
2017-09-07 10:26:15,703 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:26:15,705 [MainThread  ] [INFO ]  0.706868752015
2017-09-07 10:26:15,705 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:26:15,707 [MainThread  ] [INFO ]  0.946324951644
2017-09-07 10:26:15,708 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:26:15,710 [MainThread  ] [INFO ]  0.710344827586
2017-09-07 10:26:15,710 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:26:15,713 [MainThread  ] [INFO ]  0.811528094547
2017-09-07 10:26:15,714 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:26:15,956 [MainThread  ] [INFO ]  testing complete...
2017-09-07 10:29:13,265 [MainThread  ] [INFO ]  (6293, 15)
2017-09-07 10:29:13,266 [MainThread  ] [INFO ]  (3101, 15)
2017-09-07 10:29:13,266 [MainThread  ] [INFO ]  testing complete...
2017-09-07 10:29:13,266 [MainThread  ] [INFO ]  Preprocess the train data with approach 2 and create various models
2017-09-07 10:29:13,319 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 10:29:13,333 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 10:29:13,355 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 10:29:13,400 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 10:29:13,414 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 10:29:13,429 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      6293   6293
unique      733      2
top     Drug024   TRUE
freq        197   4107
2017-09-07 10:29:21,488 [MainThread  ] [INFO ]  {4: 6005.0}
2017-09-07 10:29:21,824 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          6293   6293
unique          308      2
top          DSC016   TRUE
freq            422   4107
2017-09-07 10:29:29,865 [MainThread  ] [INFO ]  {4: 5669.0}
2017-09-07 10:29:30,009 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       6293   6293
unique       247      2
top        DC016   TRUE
freq         422   4107
2017-09-07 10:29:32,986 [MainThread  ] [INFO ]  {4: 5644.0}
2017-09-07 10:29:33,130 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              6293   6293
unique              485      2
top              DCN024   TRUE
freq                279   4107
2017-09-07 10:29:40,681 [MainThread  ] [INFO ]  {4: 5994.0}
2017-09-07 10:29:40,879 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      6293   6293
unique      965      2
top     DGPI025   TRUE
freq        185   4107
2017-09-07 10:29:44,079 [MainThread  ] [INFO ]  {4: 5992.0}
2017-09-07 10:29:44,228 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     6293   6293
unique    1578      2
top     NDC026   TRUE
freq       182   4107
2017-09-07 10:29:46,169 [MainThread  ] [INFO ]  {4: 6070.0}
2017-09-07 10:29:46,312 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       6293   6293
unique        77      2
top        DG004   TRUE
freq        1032   4107
2017-09-07 10:29:53,630 [MainThread  ] [INFO ]  {4: 4912.0}
2017-09-07 10:29:53,778 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       6293   6293
unique       834      2
top         G060   TRUE
freq         458   4107
2017-09-07 10:29:56,329 [MainThread  ] [INFO ]  {4: 5641.0}
2017-09-07 10:29:56,476 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   6293   6293
unique    96      2
top     B003   TRUE
freq    1300   4107
2017-09-07 10:29:59,525 [MainThread  ] [INFO ]  {4: 4853.0}
2017-09-07 10:29:59,668 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      6293   6293
unique      195      2
top     PCN0005   TRUE
freq       1026   4107
2017-09-07 10:30:09,443 [MainThread  ] [INFO ]  {4: 4377.0}
2017-09-07 10:30:09,587 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     6293   6293
unique      46      2
top     State2   TRUE
freq      1370   4107
2017-09-07 10:30:14,037 [MainThread  ] [INFO ]  {4: 3696.0}
2017-09-07 10:30:14,265 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn        ...          \
count       6293      6293  6293     6293        ...           
unique        77       834    96      195        ...           
top        DG004      G060  B003  PCN0005        ...           
freq        1032       458  1300     1026        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      6293                  6293   
unique                        4                     4   
top                           1                     1   
freq                       3814                  3721   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           6293             6293             6293   
unique                             4                4                4   
top                                0                1                0   
freq                            4097             3945             4066   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    6293                   6293             6293   
unique                      4                      4                4   
top                         0                      0                1   
freq                     3758                   3832             4032   

        pcn_cluster_num  state_cluster_num  
count              6293               6293  
unique                4                  4  
top                   0                  0  
freq               3138               2880  

[4 rows x 23 columns]
2017-09-07 10:30:14,295 [MainThread  ] [INFO ]          target  drug_cluster_num  drugsubclass_cluster_num  \
count     6293              6293                      6293   
unique       2                 4                         4   
top          1                 1                         1   
freq      4107              3938                      3814   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    6293                          6293             6293   
unique                      4                             4                4   
top                         1                             0                1   
freq                     3721                          4097             3945   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              6293                   6293                   6293   
unique                4                      4                      4   
top                   0                      0                      0   
freq               4066                   3758                   3832   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              6293             6293               6293  
unique                4                4                  4  
top                   1                0                  0  
freq               4032             3138               2880  
2017-09-07 10:30:14,317 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
4562                   0                   1                   0   
3365                   1                   0                   0   
2709                   0                   1                   0   
2357                   1                   0                   0   
6962                   0                   1                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
4562                   0                           0   
3365                   0                           1   
2709                   0                           0   
2357                   0                           1   
6962                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
4562                           1                           0   
3365                           0                           0   
2709                           1                           0   
2357                           0                           0   
6962                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
4562                           0                        0   
3365                           0                        1   
2709                           0                        0   
2357                           0                        1   
6962                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
4562                        1         ...                           1   
3365                        0         ...                           0   
2709                        1         ...                           0   
2357                        0         ...                           0   
6962                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
4562                  0                  1                  0   
3365                  0                  1                  0   
2709                  0                  0                  0   
2357                  0                  0                  1   
6962                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
4562                  0                  0                    1   
3365                  0                  0                    0   
2709                  1                  0                    1   
2357                  0                  0                    0   
6962                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
4562                    0                    0                    0  
3365                    0                    1                    0  
2709                    0                    0                    0  
2357                    0                    1                    0  
6962                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:30:14,338 [MainThread  ] [INFO ]  Create Random Forest Model
2017-09-07 10:30:16,924 [MainThread  ] [INFO ]  Scores after performing cross validation :: [ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
2017-09-07 10:30:16,932 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 10:30:16,938 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 10:30:16,986 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:30:17,036 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 1.  0.  1. ...,  0.  1.  0.]
2017-09-07 10:30:17,036 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 10:30:17,354 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:30:17,477 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:17,478 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:30:17,842 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:17,842 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:30:18,036 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is train]=======================
2017-09-07 10:30:18,036 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:18,037 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:18,037 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:18,039 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:18,040 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:18,042 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:18,042 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:18,045 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:18,046 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:18,360 [MainThread  ] [INFO ]  Build Neural Net Model
2017-09-07 10:30:18,458 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 10:30:18,460 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 10:30:18,463 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:30:18,467 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99909795e-001   4.40759948e-241   9.99909795e-001 ...,
   1.71642729e-278   9.99909795e-001   4.40759948e-241]
2017-09-07 10:30:18,875 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:30:19,047 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:19,047 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:30:19,547 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:19,547 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:30:19,869 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is train]=======================
2017-09-07 10:30:19,870 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:19,871 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:19,872 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:19,876 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:19,876 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:19,879 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:19,879 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:19,884 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:19,884 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:20,165 [MainThread  ] [INFO ]  Build SVM Model
2017-09-07 10:30:20,335 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 10:30:20,337 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 10:30:20,353 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:30:20,374 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99996960e-01   1.03486814e-03   9.99999946e-01 ...,   3.54450549e-04
   9.99996966e-01   1.03486814e-03]
2017-09-07 10:30:20,733 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:30:20,867 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:20,867 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:30:21,205 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:21,205 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:30:21,408 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is train]=======================
2017-09-07 10:30:21,409 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:21,410 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:21,410 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:21,413 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:21,413 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:21,416 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:21,417 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:21,419 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:21,419 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:21,734 [MainThread  ] [INFO ]  Build Naives Bayes Model
2017-09-07 10:30:21,741 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 10:30:21,742 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 10:30:21,745 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:30:21,748 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.00000000e+00   3.35169917e-29   1.00000000e+00 ...,   8.12708853e-34
   1.00000000e+00   3.35169917e-29]
2017-09-07 10:30:22,102 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:30:22,227 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:22,227 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:30:22,556 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:22,556 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:30:22,751 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is train]=======================
2017-09-07 10:30:22,751 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:22,753 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:22,753 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:22,755 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:22,755 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:22,758 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:22,758 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:22,760 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:22,761 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:23,015 [MainThread  ] [INFO ]  Build Gradient Boosting Model
2017-09-07 10:30:26,989 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_gbm.sav
2017-09-07 10:30:27,028 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 10:30:27,081 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:30:27,135 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99773301e-01   4.26585356e-04   9.99773301e-01 ...,   4.26585356e-04
   9.99773301e-01   4.26585356e-04]
2017-09-07 10:30:27,136 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 10:30:27,524 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:30:27,691 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:27,692 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:30:28,090 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:28,090 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:30:28,309 [MainThread  ] [INFO ]  ================ Evaluation metrics for model gbm [Dataset is train]=======================
2017-09-07 10:30:28,309 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:28,311 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:28,311 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:28,313 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:28,314 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:28,318 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:28,318 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:28,322 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:28,322 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:28,549 [MainThread  ] [INFO ]  training complete...
2017-09-07 10:30:28,549 [MainThread  ] [INFO ]  evaluate the models on the test data
2017-09-07 10:30:28,587 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 10:30:28,606 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 10:30:28,624 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 10:30:28,676 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 10:30:28,692 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 10:30:28,705 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      3101   3101
unique      630      3
top     Drug019   TRUE
freq        118   2068
2017-09-07 10:30:30,784 [MainThread  ] [INFO ]  {4: 2916.0}
2017-09-07 10:30:30,936 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          3101   3101
unique          281      3
top          DSC016   TRUE
freq            194   2068
2017-09-07 10:30:33,938 [MainThread  ] [INFO ]  {4: 2774.0}
2017-09-07 10:30:34,080 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       3101   3101
unique       229      3
top        DC016   TRUE
freq         194   2068
2017-09-07 10:30:35,946 [MainThread  ] [INFO ]  {4: 2763.0}
2017-09-07 10:30:36,092 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              3101   3101
unique              430      3
top              DCN024   TRUE
freq                142   2068
2017-09-07 10:30:38,306 [MainThread  ] [INFO ]  {4: 2822.0}
2017-09-07 10:30:38,459 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      3101   3101
unique      814      3
top     DGPI025   TRUE
freq         92   2068
2017-09-07 10:30:39,744 [MainThread  ] [INFO ]  {4: 2963.0}
2017-09-07 10:30:39,889 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     3101   3101
unique    1281      3
top     NDC026   TRUE
freq        89   2068
2017-09-07 10:30:40,940 [MainThread  ] [INFO ]  {4: 2974.0}
2017-09-07 10:30:41,082 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       3101   3101
unique        78      3
top        DG004   TRUE
freq         516   2068
2017-09-07 10:30:42,410 [MainThread  ] [INFO ]  {4: 2452.0}
2017-09-07 10:30:42,553 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       3101   3101
unique       693      3
top         G060   TRUE
freq         219   2068
2017-09-07 10:30:44,956 [MainThread  ] [INFO ]  {4: 2772.0}
2017-09-07 10:30:45,094 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   3101   3101
unique    94      3
top     B003   TRUE
freq     627   2068
2017-09-07 10:30:46,368 [MainThread  ] [INFO ]  {4: 2159.0}
2017-09-07 10:30:46,595 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      3101   3101
unique      178      3
top     PCN0005   TRUE
freq        539   2068
2017-09-07 10:30:47,676 [MainThread  ] [INFO ]  {4: 2309.0}
2017-09-07 10:30:47,814 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     3101   3101
unique      48      3
top     State2   TRUE
freq       659   2068
2017-09-07 10:30:49,108 [MainThread  ] [INFO ]  {4: 1826.0}
2017-09-07 10:30:49,329 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn        ...          \
count       3101      3101  3101     3101        ...           
unique        78       693    94      178        ...           
top        DG004      G060  B003  PCN0005        ...           
freq         516       219   627      539        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      3101                  3101   
unique                        4                     4   
top                           0                     0   
freq                       2018                  2028   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           3101             3101             3101   
unique                             4                4                4   
top                                2                0                1   
freq                            1952             2073             2044   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    3101                   3101             3101   
unique                      4                      4                4   
top                         0                      1                1   
freq                     1991                   1898             1752   

        pcn_cluster_num  state_cluster_num  
count              3101               3101  
unique                4                  4  
top                   0                  0  
freq               1815               1556  

[4 rows x 23 columns]
2017-09-07 10:30:49,365 [MainThread  ] [INFO ]  test data pre-processed describe ::         target  drug_cluster_num  drugsubclass_cluster_num  \
count     3101              3101                      3101   
unique       2                 4                         4   
top          1                 0                         0   
freq      2068              2062                      2018   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    3101                          3101             3101   
unique                      4                             4                4   
top                         0                             2                0   
freq                     2028                          1952             2073   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              3101                   3101                   3101   
unique                4                      4                      4   
top                   1                      0                      1   
freq               2044                   1991                   1898   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              3101             3101               3101  
unique                4                4                  4  
top                   1                0                  0  
freq               1752             1815               1556  
2017-09-07 10:30:49,378 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   1                   0   
1731                   0                   1                   0   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           0   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           1   
1731                           0                           1   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        0         ...                           0   
1731                        0         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  1   
1731                  0                  0                  1   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  0                    0   
1731                  0                  0                    0   
6423                  1                  0                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:30:49,398 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 10:30:49,398 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 10:30:49,400 [MainThread  ] [INFO ]  y_pred is :: [1 1 1 ..., 0 1 0]
2017-09-07 10:30:49,402 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.99999993  0.99999995  0.99999995 ...,  0.26156946  0.70022546
  0.00663091]
2017-09-07 10:30:49,741 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   0 1033]
 [1689  379]]
2017-09-07 10:30:49,871 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:49,871 [MainThread  ] [INFO ]  [[   0 1033]
 [1689  379]]
2017-09-07 10:30:50,206 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:50,207 [MainThread  ] [INFO ]  [[ 0.          1.        ]
 [ 0.81673114  0.18326886]]
2017-09-07 10:30:50,399 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is test]=======================
2017-09-07 10:30:50,399 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:50,400 [MainThread  ] [INFO ]  0.122218639149
2017-09-07 10:30:50,400 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:50,402 [MainThread  ] [INFO ]  0.183268858801
2017-09-07 10:30:50,402 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:50,404 [MainThread  ] [INFO ]  0.268413597734
2017-09-07 10:30:50,404 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:50,406 [MainThread  ] [INFO ]  0.217816091954
2017-09-07 10:30:50,406 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:50,668 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   1                   0   
1731                   0                   1                   0   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           0   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           1   
1731                           0                           1   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        0         ...                           0   
1731                        0         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  1   
1731                  0                  0                  1   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  0                    0   
1731                  0                  0                    0   
6423                  1                  0                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:30:50,690 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 10:30:50,696 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 10:30:50,725 [MainThread  ] [INFO ]  y_pred is :: [1 1 1 ..., 0 0 0]
2017-09-07 10:30:50,753 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.65  0.67  0.67 ...,  0.44  0.4   0.37]
2017-09-07 10:30:51,069 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   0 1033]
 [1890  178]]
2017-09-07 10:30:51,195 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:51,195 [MainThread  ] [INFO ]  [[   0 1033]
 [1890  178]]
2017-09-07 10:30:51,524 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:51,525 [MainThread  ] [INFO ]  [[ 0.         1.       ]
 [ 0.9139265  0.0860735]]
2017-09-07 10:30:51,809 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is test]=======================
2017-09-07 10:30:51,809 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:51,811 [MainThread  ] [INFO ]  0.0574008384392
2017-09-07 10:30:51,811 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:51,813 [MainThread  ] [INFO ]  0.0860735009671
2017-09-07 10:30:51,813 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:51,815 [MainThread  ] [INFO ]  0.146985962015
2017-09-07 10:30:51,815 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:51,817 [MainThread  ] [INFO ]  0.10856968588
2017-09-07 10:30:51,818 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:52,064 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   1                   0   
1731                   0                   1                   0   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           0   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           1   
1731                           0                           1   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        0         ...                           0   
1731                        0         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  1   
1731                  0                  0                  1   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  0                    0   
1731                  0                  0                    0   
6423                  1                  0                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:30:52,094 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 10:30:52,096 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 10:30:52,098 [MainThread  ] [INFO ]  y_pred is :: [0 0 0 ..., 0 0 0]
2017-09-07 10:30:52,100 [MainThread  ] [INFO ]  y_pred probabilities is :: [  3.00874413e-047   4.88632437e-026   4.88632437e-026 ...,
   6.03469470e-111   3.47625456e-086   5.32446070e-111]
2017-09-07 10:30:52,442 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[1022   11]
 [2068    0]]
2017-09-07 10:30:52,563 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:52,563 [MainThread  ] [INFO ]  [[1022   11]
 [2068    0]]
2017-09-07 10:30:52,905 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:52,905 [MainThread  ] [INFO ]  [[ 0.9893514  0.0106486]
 [ 1.         0.       ]]
2017-09-07 10:30:53,097 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is test]=======================
2017-09-07 10:30:53,097 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:53,098 [MainThread  ] [INFO ]  0.329571106095
2017-09-07 10:30:53,099 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:53,100 [MainThread  ] [INFO ]  0.0
2017-09-07 10:30:53,100 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:53,102 [MainThread  ] [INFO ]  0.0
2017-09-07 10:30:53,102 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:53,103 [MainThread  ] [INFO ]  0.0
2017-09-07 10:30:53,103 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:53,348 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   1                   0   
1731                   0                   1                   0   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           0   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           1   
1731                           0                           1   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        0         ...                           0   
1731                        0         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  1   
1731                  0                  0                  1   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  0                    0   
1731                  0                  0                    0   
6423                  1                  0                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:30:53,369 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 10:30:53,369 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 10:30:53,377 [MainThread  ] [INFO ]  y_pred is :: [1 1 1 ..., 0 1 0]
2017-09-07 10:30:53,386 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.87941451  0.88906235  0.88906235 ...,  0.45099187  0.54749222
  0.35480716]
2017-09-07 10:30:53,737 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   0 1033]
 [1915  153]]
2017-09-07 10:30:53,870 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:53,870 [MainThread  ] [INFO ]  [[   0 1033]
 [1915  153]]
2017-09-07 10:30:54,214 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:54,215 [MainThread  ] [INFO ]  [[ 0.          1.        ]
 [ 0.92601547  0.07398453]]
2017-09-07 10:30:54,511 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is test]=======================
2017-09-07 10:30:54,512 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:54,513 [MainThread  ] [INFO ]  0.0493389229281
2017-09-07 10:30:54,514 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:54,518 [MainThread  ] [INFO ]  0.0739845261122
2017-09-07 10:30:54,519 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:54,523 [MainThread  ] [INFO ]  0.129005059022
2017-09-07 10:30:54,523 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:54,529 [MainThread  ] [INFO ]  0.0940381069453
2017-09-07 10:30:54,529 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:54,926 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   1                   0   
1731                   0                   1                   0   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           0   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           1                           0   
8295                           0                           1   
1731                           0                           1   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        0         ...                           0   
1731                        0         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  1                  0   
8295                  0                  0                  1   
1731                  0                  0                  1   
6423                  0                  0                  0   
8706                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  0                  0                    1   
8295                  0                  0                    0   
1731                  0                  0                    0   
6423                  1                  0                    0   
8706                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    0                    0                    0  
8295                    1                    0                    0  
1731                    1                    0                    0  
6423                    0                    1                    0  
8706                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:30:54,946 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_gbm.sav
2017-09-07 10:30:54,984 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 10:30:55,011 [MainThread  ] [INFO ]  y_pred is :: [1 0 0 ..., 1 1 1]
2017-09-07 10:30:55,037 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.99976527  0.46402426  0.46402426 ...,  0.68340175  0.68340175
  0.68340175]
2017-09-07 10:30:55,353 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 780  253]
 [   0 2068]]
2017-09-07 10:30:55,484 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:30:55,484 [MainThread  ] [INFO ]  [[ 780  253]
 [   0 2068]]
2017-09-07 10:30:55,817 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:30:55,817 [MainThread  ] [INFO ]  [[ 0.75508228  0.24491772]
 [ 0.          1.        ]]
2017-09-07 10:30:56,012 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is test]=======================
2017-09-07 10:30:56,012 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:30:56,013 [MainThread  ] [INFO ]  0.918413415027
2017-09-07 10:30:56,013 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:30:56,016 [MainThread  ] [INFO ]  1.0
2017-09-07 10:30:56,016 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:30:56,018 [MainThread  ] [INFO ]  0.890995260664
2017-09-07 10:30:56,018 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:30:56,021 [MainThread  ] [INFO ]  0.942355889724
2017-09-07 10:30:56,021 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:30:56,256 [MainThread  ] [INFO ]  testing complete...
2017-09-07 10:35:02,035 [MainThread  ] [INFO ]  (6293, 15)
2017-09-07 10:35:02,035 [MainThread  ] [INFO ]  (3101, 15)
2017-09-07 10:35:02,035 [MainThread  ] [INFO ]  testing complete...
2017-09-07 10:35:02,035 [MainThread  ] [INFO ]  Preprocess the train data with approach 2 and create various models
2017-09-07 10:35:02,082 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 10:35:02,096 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 10:35:02,118 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 10:35:02,166 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        77       834    96      195      46      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1032       458  1300     1026    1370   4107  
2017-09-07 10:35:02,180 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 10:35:02,195 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      6293   6293
unique      733      2
top     Drug024   TRUE
freq        197   4107
2017-09-07 10:35:04,310 [MainThread  ] [INFO ]  {4: 5943.0}
2017-09-07 10:35:04,609 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          6293   6293
unique          308      2
top          DSC016   TRUE
freq            422   4107
2017-09-07 10:35:11,957 [MainThread  ] [INFO ]  {4: 5698.0}
2017-09-07 10:35:12,101 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       6293   6293
unique       247      2
top        DC016   TRUE
freq         422   4107
2017-09-07 10:35:15,896 [MainThread  ] [INFO ]  {4: 5694.0}
2017-09-07 10:35:16,043 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              6293   6293
unique              485      2
top              DCN024   TRUE
freq                279   4107
2017-09-07 10:35:18,890 [MainThread  ] [INFO ]  {4: 5876.0}
2017-09-07 10:35:19,085 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      6293   6293
unique      965      2
top     DGPI025   TRUE
freq        185   4107
2017-09-07 10:35:21,551 [MainThread  ] [INFO ]  {4: 5916.0}
2017-09-07 10:35:21,706 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     6293   6293
unique    1578      2
top     NDC026   TRUE
freq       182   4107
2017-09-07 10:35:29,525 [MainThread  ] [INFO ]  {4: 6061.0}
2017-09-07 10:35:29,670 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       6293   6293
unique        77      2
top        DG004   TRUE
freq        1032   4107
2017-09-07 10:35:32,066 [MainThread  ] [INFO ]  {4: 5076.0}
2017-09-07 10:35:32,208 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       6293   6293
unique       834      2
top         G060   TRUE
freq         458   4107
2017-09-07 10:35:34,590 [MainThread  ] [INFO ]  {4: 5707.0}
2017-09-07 10:35:34,733 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   6293   6293
unique    96      2
top     B003   TRUE
freq    1300   4107
2017-09-07 10:35:37,835 [MainThread  ] [INFO ]  {4: 4569.0}
2017-09-07 10:35:37,985 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      6293   6293
unique      195      2
top     PCN0005   TRUE
freq       1026   4107
2017-09-07 10:35:41,340 [MainThread  ] [INFO ]  {4: 4858.0}
2017-09-07 10:35:41,483 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     6293   6293
unique      46      2
top     State2   TRUE
freq      1370   4107
2017-09-07 10:35:48,244 [MainThread  ] [INFO ]  {4: 4190.0}
2017-09-07 10:35:48,506 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      733          308       247              485      965    1578   
top     Drug024       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        197          422       422              279      185     182   

       druggroup rxgroupid   bin      pcn        ...          \
count       6293      6293  6293     6293        ...           
unique        77       834    96      195        ...           
top        DG004      G060  B003  PCN0005        ...           
freq        1032       458  1300     1026        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      6293                  6293   
unique                        4                     4   
top                           1                     1   
freq                       3843                  3822   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           6293             6293             6293   
unique                             4                4                4   
top                                1                1                0   
freq                            3957             3915             4069   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    6293                   6293             6293   
unique                      4                      4                4   
top                         0                      0                0   
freq                     4032                   3979             3683   

        pcn_cluster_num  state_cluster_num  
count              6293               6293  
unique                4                  4  
top                   1                  0  
freq               3698               3416  

[4 rows x 23 columns]
2017-09-07 10:35:48,540 [MainThread  ] [INFO ]          target  drug_cluster_num  drugsubclass_cluster_num  \
count     6293              6293                      6293   
unique       2                 4                         4   
top          1                 1                         1   
freq      4107              4077                      3843   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    6293                          6293             6293   
unique                      4                             4                4   
top                         1                             1                1   
freq                     3822                          3957             3915   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              6293                   6293                   6293   
unique                4                      4                      4   
top                   0                      0                      0   
freq               4069                   4032                   3979   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              6293             6293               6293  
unique                4                4                  4  
top                   0                1                  0  
freq               3683             3698               3416  
2017-09-07 10:35:48,563 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
4562                   0                   1                   0   
3365                   1                   0                   0   
2709                   0                   1                   0   
2357                   1                   0                   0   
6962                   0                   1                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
4562                   0                           0   
3365                   0                           1   
2709                   0                           0   
2357                   0                           1   
6962                   0                           0   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
4562                           1                           0   
3365                           0                           0   
2709                           1                           0   
2357                           0                           0   
6962                           1                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
4562                           0                        0   
3365                           0                        1   
2709                           0                        0   
2357                           0                        1   
6962                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
4562                        1         ...                           0   
3365                        0         ...                           0   
2709                        1         ...                           0   
2357                        0         ...                           0   
6962                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
4562                  0                  0                  1   
3365                  1                  1                  0   
2709                  0                  0                  0   
2357                  1                  1                  0   
6962                  0                  0                  1   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
4562                  0                  0                    1   
3365                  0                  0                    0   
2709                  1                  0                    1   
2357                  0                  0                    0   
6962                  0                  0                    1   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
4562                    0                    0                    0  
3365                    0                    1                    0  
2709                    0                    0                    0  
2357                    0                    1                    0  
6962                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:35:48,583 [MainThread  ] [INFO ]  Create Random Forest Model
2017-09-07 10:35:50,967 [MainThread  ] [INFO ]  Scores after performing cross validation :: [ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
2017-09-07 10:35:50,973 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 10:35:50,979 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 10:35:51,027 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:35:51,075 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 1.  0.  1. ...,  0.  1.  0.]
2017-09-07 10:35:51,076 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 10:35:51,392 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:35:51,517 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:35:51,517 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:35:51,859 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:35:51,859 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:35:52,073 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is train]=======================
2017-09-07 10:35:52,073 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:35:52,075 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:52,075 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:35:52,077 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:52,077 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:35:52,080 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:52,080 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:35:52,082 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:52,082 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:35:52,399 [MainThread  ] [INFO ]  Build Neural Net Model
2017-09-07 10:35:52,579 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 10:35:52,581 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 10:35:52,585 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 1]
2017-09-07 10:35:52,587 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.16645326e-01   2.75137978e-07   9.16645326e-01 ...,   2.75137978e-07
   9.16645326e-01   9.16645326e-01]
2017-09-07 10:35:52,933 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[1812  374]
 [   0 4107]]
2017-09-07 10:35:53,064 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:35:53,064 [MainThread  ] [INFO ]  [[1812  374]
 [   0 4107]]
2017-09-07 10:35:53,395 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:35:53,396 [MainThread  ] [INFO ]  [[ 0.82891125  0.17108875]
 [ 0.          1.        ]]
2017-09-07 10:35:53,589 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is train]=======================
2017-09-07 10:35:53,589 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:35:53,591 [MainThread  ] [INFO ]  0.940568886064
2017-09-07 10:35:53,591 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:35:53,593 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:53,594 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:35:53,596 [MainThread  ] [INFO ]  0.916536487391
2017-09-07 10:35:53,596 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:35:53,598 [MainThread  ] [INFO ]  0.956450861667
2017-09-07 10:35:53,599 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:35:53,835 [MainThread  ] [INFO ]  Build SVM Model
2017-09-07 10:35:53,961 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 10:35:53,962 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 10:35:53,976 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:35:53,999 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99998563e-01   4.60280145e-04   9.99999868e-01 ...,   4.60280145e-04
   9.99999283e-01   4.59794868e-04]
2017-09-07 10:35:54,320 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:35:54,446 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:35:54,446 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:35:54,779 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:35:54,779 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:35:54,973 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is train]=======================
2017-09-07 10:35:54,973 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:35:54,975 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:54,975 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:35:54,977 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:54,978 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:35:54,980 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:54,980 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:35:54,983 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:54,983 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:35:55,300 [MainThread  ] [INFO ]  Build Naives Bayes Model
2017-09-07 10:35:55,308 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 10:35:55,309 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 10:35:55,311 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:35:55,314 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.00000000e+00   8.29958701e-38   1.00000000e+00 ...,   8.29958701e-38
   1.00000000e+00   2.71237586e-34]
2017-09-07 10:35:55,662 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:35:55,790 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:35:55,790 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:35:56,142 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:35:56,142 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:35:56,337 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is train]=======================
2017-09-07 10:35:56,337 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:35:56,339 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:56,339 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:35:56,343 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:56,343 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:35:56,346 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:56,346 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:35:56,351 [MainThread  ] [INFO ]  1.0
2017-09-07 10:35:56,351 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:35:56,588 [MainThread  ] [INFO ]  Build Gradient Boosting Model
2017-09-07 10:36:00,492 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_gbm.sav
2017-09-07 10:36:00,530 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 10:36:00,582 [MainThread  ] [INFO ]  y_pred is :: [1 0 1 ..., 0 1 0]
2017-09-07 10:36:00,636 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99773311e-01   4.26616484e-04   9.99773311e-01 ...,   4.26616484e-04
   9.99773311e-01   4.26616484e-04]
2017-09-07 10:36:00,636 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 10:36:00,946 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2186    0]
 [   0 4107]]
2017-09-07 10:36:01,086 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:36:01,086 [MainThread  ] [INFO ]  [[2186    0]
 [   0 4107]]
2017-09-07 10:36:01,528 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:36:01,528 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 10:36:01,768 [MainThread  ] [INFO ]  ================ Evaluation metrics for model gbm [Dataset is train]=======================
2017-09-07 10:36:01,769 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:36:01,770 [MainThread  ] [INFO ]  1.0
2017-09-07 10:36:01,771 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:36:01,774 [MainThread  ] [INFO ]  1.0
2017-09-07 10:36:01,774 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:36:01,777 [MainThread  ] [INFO ]  1.0
2017-09-07 10:36:01,777 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:36:01,780 [MainThread  ] [INFO ]  1.0
2017-09-07 10:36:01,780 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:36:02,015 [MainThread  ] [INFO ]  training complete...
2017-09-07 10:36:02,015 [MainThread  ] [INFO ]  evaluate the models on the test data
2017-09-07 10:36:02,064 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 10:36:02,082 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 10:36:02,099 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 10:36:02,143 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        78       693    94      178      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         516       219   627      539     659   2068  
2017-09-07 10:36:02,157 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 10:36:02,171 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      3101   3101
unique      630      3
top     Drug019   TRUE
freq        118   2068
2017-09-07 10:36:04,120 [MainThread  ] [INFO ]  {4: 2920.0}
2017-09-07 10:36:04,285 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          3101   3101
unique          281      3
top          DSC016   TRUE
freq            194   2068
2017-09-07 10:36:07,107 [MainThread  ] [INFO ]  {4: 2748.0}
2017-09-07 10:36:07,271 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       3101   3101
unique       229      3
top        DC016   TRUE
freq         194   2068
2017-09-07 10:36:08,703 [MainThread  ] [INFO ]  {4: 2792.0}
2017-09-07 10:36:08,852 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              3101   3101
unique              430      3
top              DCN024   TRUE
freq                142   2068
2017-09-07 10:36:10,194 [MainThread  ] [INFO ]  {4: 2863.0}
2017-09-07 10:36:10,345 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      3101   3101
unique      814      3
top     DGPI025   TRUE
freq         92   2068
2017-09-07 10:36:11,808 [MainThread  ] [INFO ]  {4: 2964.0}
2017-09-07 10:36:11,957 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     3101   3101
unique    1281      3
top     NDC026   TRUE
freq        89   2068
2017-09-07 10:36:16,458 [MainThread  ] [INFO ]  {4: 2996.0}
2017-09-07 10:36:16,608 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       3101   3101
unique        78      3
top        DG004   TRUE
freq         516   2068
2017-09-07 10:36:17,951 [MainThread  ] [INFO ]  {4: 2462.0}
2017-09-07 10:36:18,093 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       3101   3101
unique       693      3
top         G060   TRUE
freq         219   2068
2017-09-07 10:36:19,352 [MainThread  ] [INFO ]  {4: 2755.0}
2017-09-07 10:36:19,589 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   3101   3101
unique    94      3
top     B003   TRUE
freq     627   2068
2017-09-07 10:36:22,195 [MainThread  ] [INFO ]  {4: 2145.0}
2017-09-07 10:36:22,391 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      3101   3101
unique      178      3
top     PCN0005   TRUE
freq        539   2068
2017-09-07 10:36:23,621 [MainThread  ] [INFO ]  {4: 2320.0}
2017-09-07 10:36:23,769 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     3101   3101
unique      48      3
top     State2   TRUE
freq       659   2068
2017-09-07 10:36:25,979 [MainThread  ] [INFO ]  {4: 2060.0}
2017-09-07 10:36:26,221 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      630          281       229              430      814    1281   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        118          194       194              142       92      89   

       druggroup rxgroupid   bin      pcn        ...          \
count       3101      3101  3101     3101        ...           
unique        78       693    94      178        ...           
top        DG004      G060  B003  PCN0005        ...           
freq         516       219   627      539        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      3101                  3101   
unique                        4                     4   
top                           0                     0   
freq                       2069                  2068   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           3101             3101             3101   
unique                             4                4                4   
top                                1                0                1   
freq                            2006             2058             2030   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    3101                   3101             3101   
unique                      4                      4                4   
top                         1                      0                0   
freq                     1790                   1871             1739   

        pcn_cluster_num  state_cluster_num  
count              3101               3101  
unique                4                  4  
top                   0                  1  
freq               1415               1612  

[4 rows x 23 columns]
2017-09-07 10:36:26,261 [MainThread  ] [INFO ]  test data pre-processed describe ::         target  drug_cluster_num  drugsubclass_cluster_num  \
count     3101              3101                      3101   
unique       2                 4                         4   
top          1                 0                         0   
freq      2068              2066                      2069   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    3101                          3101             3101   
unique                      4                             4                4   
top                         0                             1                0   
freq                     2068                          2006             2058   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              3101                   3101                   3101   
unique                4                      4                      4   
top                   1                      1                      0   
freq               2030                   1790                   1871   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              3101             3101               3101  
unique                4                4                  4  
top                   0                0                  1  
freq               1739             1415               1612  
2017-09-07 10:36:26,274 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           1   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           0                           0   
8295                           1                           0   
1731                           1                           0   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  0                  0   
8295                  1                  1                  0   
1731                  0                  1                  0   
6423                  0                  0                  0   
8706                  0                  0                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  1                  0                    0   
8295                  0                  0                    1   
1731                  0                  0                    1   
6423                  0                  1                    0   
8706                  1                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    0  
1731                    0                    0                    0  
6423                    1                    0                    0  
8706                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:36:26,298 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 10:36:26,299 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 10:36:26,300 [MainThread  ] [INFO ]  y_pred is :: [0 1 1 ..., 0 0 0]
2017-09-07 10:36:26,303 [MainThread  ] [INFO ]  y_pred probabilities is :: [  2.93874530e-13   1.00000000e+00   1.00000000e+00 ...,   1.37517387e-01
   1.11614332e-16   1.05741399e-10]
2017-09-07 10:36:26,675 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   1 1032]
 [2028   40]]
2017-09-07 10:36:26,796 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:36:26,796 [MainThread  ] [INFO ]  [[   1 1032]
 [2028   40]]
2017-09-07 10:36:27,132 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:36:27,132 [MainThread  ] [INFO ]  [[  9.68054211e-04   9.99031946e-01]
 [  9.80657640e-01   1.93423598e-02]]
2017-09-07 10:36:27,318 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is test]=======================
2017-09-07 10:36:27,318 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:36:27,319 [MainThread  ] [INFO ]  0.0132215414382
2017-09-07 10:36:27,320 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:36:27,322 [MainThread  ] [INFO ]  0.0193423597679
2017-09-07 10:36:27,322 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:36:27,325 [MainThread  ] [INFO ]  0.0373134328358
2017-09-07 10:36:27,325 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:36:27,327 [MainThread  ] [INFO ]  0.0254777070064
2017-09-07 10:36:27,327 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:36:27,574 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           1   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           0                           0   
8295                           1                           0   
1731                           1                           0   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  0                  0   
8295                  1                  1                  0   
1731                  0                  1                  0   
6423                  0                  0                  0   
8706                  0                  0                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  1                  0                    0   
8295                  0                  0                    1   
1731                  0                  0                    1   
6423                  0                  1                    0   
8706                  1                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    0  
1731                    0                    0                    0  
6423                    1                    0                    0  
8706                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:36:27,595 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 10:36:27,600 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 10:36:27,628 [MainThread  ] [INFO ]  y_pred is :: [0 1 1 ..., 1 0 1]
2017-09-07 10:36:27,656 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.47  0.65  0.67 ...,  0.57  0.38  0.54]
2017-09-07 10:36:27,987 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   2 1031]
 [ 604 1464]]
2017-09-07 10:36:28,116 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:36:28,116 [MainThread  ] [INFO ]  [[   2 1031]
 [ 604 1464]]
2017-09-07 10:36:28,451 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:36:28,451 [MainThread  ] [INFO ]  [[ 0.00193611  0.99806389]
 [ 0.29206963  0.70793037]]
2017-09-07 10:36:28,730 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is test]=======================
2017-09-07 10:36:28,730 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:36:28,731 [MainThread  ] [INFO ]  0.472750725572
2017-09-07 10:36:28,732 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:36:28,735 [MainThread  ] [INFO ]  0.707930367505
2017-09-07 10:36:28,735 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:36:28,737 [MainThread  ] [INFO ]  0.586773547094
2017-09-07 10:36:28,737 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:36:28,739 [MainThread  ] [INFO ]  0.641683103222
2017-09-07 10:36:28,740 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:36:29,033 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           1   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           0                           0   
8295                           1                           0   
1731                           1                           0   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  0                  0   
8295                  1                  1                  0   
1731                  0                  1                  0   
6423                  0                  0                  0   
8706                  0                  0                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  1                  0                    0   
8295                  0                  0                    1   
1731                  0                  0                    1   
6423                  0                  1                    0   
8706                  1                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    0  
1731                    0                    0                    0  
6423                    1                    0                    0  
8706                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:36:29,058 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 10:36:29,059 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 10:36:29,061 [MainThread  ] [INFO ]  y_pred is :: [1 1 1 ..., 1 1 1]
2017-09-07 10:36:29,062 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.91664533  0.91664533  0.91664533 ...,  0.91664533  0.91664533
  0.91664533]
2017-09-07 10:36:29,429 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   0 1033]
 [   0 2068]]
2017-09-07 10:36:29,567 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:36:29,567 [MainThread  ] [INFO ]  [[   0 1033]
 [   0 2068]]
2017-09-07 10:36:29,901 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:36:29,901 [MainThread  ] [INFO ]  [[ 0.  1.]
 [ 0.  1.]]
2017-09-07 10:36:30,096 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is test]=======================
2017-09-07 10:36:30,096 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:36:30,097 [MainThread  ] [INFO ]  0.66688165108
2017-09-07 10:36:30,097 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:36:30,099 [MainThread  ] [INFO ]  1.0
2017-09-07 10:36:30,099 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:36:30,100 [MainThread  ] [INFO ]  0.66688165108
2017-09-07 10:36:30,101 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:36:30,102 [MainThread  ] [INFO ]  0.800154768814
2017-09-07 10:36:30,102 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:36:30,357 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           1   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           0                           0   
8295                           1                           0   
1731                           1                           0   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  0                  0   
8295                  1                  1                  0   
1731                  0                  1                  0   
6423                  0                  0                  0   
8706                  0                  0                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  1                  0                    0   
8295                  0                  0                    1   
1731                  0                  0                    1   
6423                  0                  1                    0   
8706                  1                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    0  
1731                    0                    0                    0  
6423                    1                    0                    0  
8706                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:36:30,380 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 10:36:30,381 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 10:36:30,388 [MainThread  ] [INFO ]  y_pred is :: [0 1 1 ..., 0 0 0]
2017-09-07 10:36:30,397 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.05291833  0.9463153   0.96059513 ...,  0.3610348   0.0249601
  0.09929518]
2017-09-07 10:36:30,705 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[   2 1031]
 [2035   33]]
2017-09-07 10:36:30,833 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:36:30,833 [MainThread  ] [INFO ]  [[   2 1031]
 [2035   33]]
2017-09-07 10:36:31,166 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:36:31,166 [MainThread  ] [INFO ]  [[ 0.00193611  0.99806389]
 [ 0.98404255  0.01595745]]
2017-09-07 10:36:31,458 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is test]=======================
2017-09-07 10:36:31,458 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:36:31,460 [MainThread  ] [INFO ]  0.0112866817156
2017-09-07 10:36:31,460 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:36:31,462 [MainThread  ] [INFO ]  0.0159574468085
2017-09-07 10:36:31,462 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:36:31,464 [MainThread  ] [INFO ]  0.031015037594
2017-09-07 10:36:31,464 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:36:31,466 [MainThread  ] [INFO ]  0.0210727969349
2017-09-07 10:36:31,466 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:36:31,709 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
2221                   1                   0                   0   
8295                   0                   0                   1   
1731                   0                   0                   1   
6423                   1                   0                   0   
8706                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
2221                   0                           1   
8295                   0                           0   
1731                   0                           0   
6423                   0                           1   
8706                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
2221                           0                           0   
8295                           1                           0   
1731                           1                           0   
6423                           0                           0   
8706                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
2221                           0                        1   
8295                           0                        0   
1731                           0                        0   
6423                           0                        1   
8706                           0                        1   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
2221                        0         ...                           1   
8295                        1         ...                           0   
1731                        1         ...                           0   
6423                        0         ...                           0   
8706                        0         ...                           1   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
2221                  0                  0                  0   
8295                  1                  1                  0   
1731                  0                  1                  0   
6423                  0                  0                  0   
8706                  0                  0                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
2221                  1                  0                    0   
8295                  0                  0                    1   
1731                  0                  0                    1   
6423                  0                  1                    0   
8706                  1                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
2221                    1                    0                    0  
8295                    0                    0                    0  
1731                    0                    0                    0  
6423                    1                    0                    0  
8706                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 10:36:31,731 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_gbm.sav
2017-09-07 10:36:31,777 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 10:36:31,802 [MainThread  ] [INFO ]  y_pred is :: [1 1 1 ..., 1 0 1]
2017-09-07 10:36:31,827 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.89664042  0.84353401  0.84353401 ...,  0.89664042  0.2698014
  0.89664042]
2017-09-07 10:36:32,150 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[  64  969]
 [ 585 1483]]
2017-09-07 10:36:32,279 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 10:36:32,280 [MainThread  ] [INFO ]  [[  64  969]
 [ 585 1483]]
2017-09-07 10:36:32,614 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 10:36:32,614 [MainThread  ] [INFO ]  [[ 0.06195547  0.93804453]
 [ 0.28288201  0.71711799]]
2017-09-07 10:36:32,838 [MainThread  ] [INFO ]  ================ Evaluation metrics for model gbm [Dataset is test]=======================
2017-09-07 10:36:32,838 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 10:36:32,840 [MainThread  ] [INFO ]  0.498871331828
2017-09-07 10:36:32,840 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 10:36:32,843 [MainThread  ] [INFO ]  0.717117988395
2017-09-07 10:36:32,843 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 10:36:32,845 [MainThread  ] [INFO ]  0.604812398042
2017-09-07 10:36:32,846 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 10:36:32,849 [MainThread  ] [INFO ]  0.656194690265
2017-09-07 10:36:32,850 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 10:36:33,160 [MainThread  ] [INFO ]  testing complete...
2017-09-07 11:03:27,800 [MainThread  ] [INFO ]  (6293, 15)
2017-09-07 11:03:27,813 [MainThread  ] [INFO ]  (3101, 15)
2017-09-07 11:03:27,814 [MainThread  ] [INFO ]  testing complete...
2017-09-07 11:03:27,814 [MainThread  ] [INFO ]  Preprocess the train data with approach 2 and create various models
2017-09-07 11:03:27,913 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      734          306       246              485      960    1575   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        222          399       399              296      197     193   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        78       829    98      195      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1054       457  1260     1059    1368   4114  
2017-09-07 11:03:27,942 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 11:03:27,971 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 11:03:28,029 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      734          306       246              485      960    1575   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        222          399       399              296      197     193   

       druggroup rxgroupid   bin      pcn   state target  
count       6293      6293  6293     6293    6293   6293  
unique        78       829    98      195      48      3  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq        1054       457  1260     1059    1368   4114  
2017-09-07 11:03:28,052 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 11:03:28,075 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      6293   6293
unique      734      3
top     Drug019   TRUE
freq        222   4114
2017-09-07 11:03:30,960 [MainThread  ] [INFO ]  {4: 5999.0}
2017-09-07 11:03:32,263 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          6293   6293
unique          306      3
top          DSC016   TRUE
freq            399   4114
2017-09-07 11:03:35,817 [MainThread  ] [INFO ]  {4: 5569.0}
2017-09-07 11:03:35,965 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       6293   6293
unique       246      3
top        DC016   TRUE
freq         399   4114
2017-09-07 11:03:44,102 [MainThread  ] [INFO ]  {4: 5644.0}
2017-09-07 11:03:44,253 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              6293   6293
unique              485      3
top              DCN024   TRUE
freq                296   4114
2017-09-07 11:03:46,837 [MainThread  ] [INFO ]  {4: 5950.0}
2017-09-07 11:03:47,031 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      6293   6293
unique      960      3
top     DGPI025   TRUE
freq        197   4114
2017-09-07 11:03:54,739 [MainThread  ] [INFO ]  {4: 6005.0}
2017-09-07 11:03:54,891 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     6293   6293
unique    1575      3
top     NDC026   TRUE
freq       193   4114
2017-09-07 11:03:57,187 [MainThread  ] [INFO ]  {4: 6044.0}
2017-09-07 11:03:57,333 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       6293   6293
unique        78      3
top        DG004   TRUE
freq        1054   4114
2017-09-07 11:04:08,944 [MainThread  ] [INFO ]  {4: 4828.0}
2017-09-07 11:04:09,087 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       6293   6293
unique       829      3
top         G060   TRUE
freq         457   4114
2017-09-07 11:04:11,468 [MainThread  ] [INFO ]  {4: 5631.0}
2017-09-07 11:04:11,612 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   6293   6293
unique    98      3
top     B003   TRUE
freq    1260   4114
2017-09-07 11:04:17,250 [MainThread  ] [INFO ]  {4: 4458.0}
2017-09-07 11:04:17,393 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      6293   6293
unique      195      3
top     PCN0005   TRUE
freq       1059   4114
2017-09-07 11:04:20,099 [MainThread  ] [INFO ]  {4: 4652.0}
2017-09-07 11:04:20,240 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     6293   6293
unique      48      3
top     State2   TRUE
freq      1368   4114
2017-09-07 11:04:24,025 [MainThread  ] [INFO ]  {4: 3938.0}
2017-09-07 11:04:24,311 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      6293         6293      6293             6293     6293    6293   
unique      734          306       246              485      960    1575   
top     Drug019       DSC016     DC016           DCN024  DGPI025  NDC026   
freq        222          399       399              296      197     193   

       druggroup rxgroupid   bin      pcn        ...          \
count       6293      6293  6293     6293        ...           
unique        78       829    98      195        ...           
top        DG004      G060  B003  PCN0005        ...           
freq        1054       457  1260     1059        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      6293                  6293   
unique                        4                     4   
top                           1                     0   
freq                       3717                  4064   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           6293             6293             6293   
unique                             4                4                4   
top                                0                1                0   
freq                            4071             3912             4113   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    6293                   6293             6293   
unique                      4                      4                4   
top                         1                      1                2   
freq                     3702                   3908             3076   

        pcn_cluster_num  state_cluster_num  
count              6293               6293  
unique                4                  4  
top                   0                  0  
freq               3532               3632  

[4 rows x 23 columns]
2017-09-07 11:04:24,352 [MainThread  ] [INFO ]          target  drug_cluster_num  drugsubclass_cluster_num  \
count     6293              6293                      6293   
unique       2                 4                         4   
top          1                 1                         1   
freq      4114              3963                      3717   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    6293                          6293             6293   
unique                      4                             4                4   
top                         0                             0                1   
freq                     4064                          4071             3912   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              6293                   6293                   6293   
unique                4                      4                      4   
top                   0                      1                      1   
freq               4113                   3702                   3908   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              6293             6293               6293  
unique                4                4                  4  
top                   2                0                  0  
freq               3076             3532               3632  
2017-09-07 11:04:24,375 [MainThread  ] [INFO ]     drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
0                   1                   0                   0   
1                   0                   1                   0   
2                   1                   0                   0   
3                   1                   0                   0   
4                   0                   1                   0   

   drug_cluster_num_3  drugsubclass_cluster_num_0  drugsubclass_cluster_num_1  \
0                   0                           1                           0   
1                   0                           0                           1   
2                   0                           1                           0   
3                   0                           1                           0   
4                   0                           0                           1   

   drugsubclass_cluster_num_2  drugsubclass_cluster_num_3  \
0                           0                           0   
1                           0                           0   
2                           0                           0   
3                           0                           0   
4                           0                           0   

   drugclass_cluster_num_0  drugclass_cluster_num_1         ...           \
0                        1                        0         ...            
1                        1                        0         ...            
2                        0                        0         ...            
3                        0                        0         ...            
4                        1                        0         ...            

   bin_cluster_num_2  bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
0                  0                  0                  1                  0   
1                  1                  0                  1                  0   
2                  0                  0                  0                  0   
3                  0                  0                  0                  0   
4                  0                  1                  0                  1   

   pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
0                  0                  0                    1   
1                  0                  0                    1   
2                  0                  1                    0   
3                  0                  1                    0   
4                  0                  0                    1   

   state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
0                    0                    0                    0  
1                    0                    0                    0  
2                    0                    1                    0  
3                    1                    0                    0  
4                    0                    0                    0  

[5 rows x 44 columns]
2017-09-07 11:04:24,395 [MainThread  ] [INFO ]  Create Random Forest Model
2017-09-07 11:04:27,197 [MainThread  ] [INFO ]  Scores after performing cross validation :: [ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
2017-09-07 11:04:27,204 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 11:04:27,209 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 11:04:27,258 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 0 0]
2017-09-07 11:04:27,308 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.15  1.    0.   ...,  0.    0.    0.  ]
2017-09-07 11:04:27,309 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 11:04:27,630 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2179    0]
 [   0 4114]]
2017-09-07 11:04:27,790 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:04:27,790 [MainThread  ] [INFO ]  [[2179    0]
 [   0 4114]]
2017-09-07 11:04:28,203 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:04:28,203 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 11:04:28,397 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is train]=======================
2017-09-07 11:04:28,398 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:04:28,399 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:28,399 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:04:28,403 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:28,403 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:04:28,407 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:28,407 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:04:28,411 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:28,412 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:04:28,822 [MainThread  ] [INFO ]  Build Neural Net Model
2017-09-07 11:04:29,133 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 11:04:29,135 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 11:04:29,138 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 0 0]
2017-09-07 11:04:29,141 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.93393498e-04   1.00000000e+00   1.95169648e-04 ...,   1.95169648e-04
   1.95169648e-04   1.95169648e-04]
2017-09-07 11:04:29,481 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2179    0]
 [   0 4114]]
2017-09-07 11:04:29,607 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:04:29,607 [MainThread  ] [INFO ]  [[2179    0]
 [   0 4114]]
2017-09-07 11:04:29,942 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:04:29,942 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 11:04:30,137 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is train]=======================
2017-09-07 11:04:30,138 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:04:30,139 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:30,140 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:04:30,142 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:30,143 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:04:30,145 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:30,146 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:04:30,149 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:30,149 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:04:30,382 [MainThread  ] [INFO ]  Build SVM Model
2017-09-07 11:04:30,516 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 11:04:30,517 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 11:04:30,532 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 0 0]
2017-09-07 11:04:30,550 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.39543238e-01   9.99999945e-01   3.37254667e-04 ...,   4.23082021e-04
   2.85999038e-04   9.88931952e-04]
2017-09-07 11:04:30,878 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2179    0]
 [   0 4114]]
2017-09-07 11:04:31,000 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:04:31,000 [MainThread  ] [INFO ]  [[2179    0]
 [   0 4114]]
2017-09-07 11:04:31,330 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:04:31,330 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 11:04:31,524 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is train]=======================
2017-09-07 11:04:31,524 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:04:31,526 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:31,526 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:04:31,528 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:31,528 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:04:31,531 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:31,531 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:04:31,533 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:31,533 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:04:31,865 [MainThread  ] [INFO ]  Build Naives Bayes Model
2017-09-07 11:04:31,872 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 11:04:31,874 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 11:04:31,875 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 0 0]
2017-09-07 11:04:31,879 [MainThread  ] [INFO ]  y_pred probabilities is :: [  3.76254730e-05   1.00000000e+00   4.64343507e-33 ...,   3.05299932e-30
   8.77093291e-34   3.81535582e-31]
2017-09-07 11:04:32,222 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2179    0]
 [   0 4114]]
2017-09-07 11:04:32,347 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:04:32,347 [MainThread  ] [INFO ]  [[2179    0]
 [   0 4114]]
2017-09-07 11:04:32,725 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:04:32,726 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 11:04:32,994 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is train]=======================
2017-09-07 11:04:32,995 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:04:32,996 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:32,996 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:04:33,003 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:33,004 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:04:33,008 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:33,009 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:04:33,012 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:33,013 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:04:33,315 [MainThread  ] [INFO ]  Build Gradient Boosting Model
2017-09-07 11:04:38,161 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_gbm.sav
2017-09-07 11:04:38,199 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 11:04:38,255 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 0 0]
2017-09-07 11:04:38,312 [MainThread  ] [INFO ]  y_pred probabilities is :: [  1.23107979e-03   9.99773704e-01   4.26691073e-04 ...,   4.26691073e-04
   4.26691073e-04   5.12363825e-04]
2017-09-07 11:04:38,313 [MainThread  ] [INFO ]  describe y_pred_train :: [0 1]
2017-09-07 11:04:38,630 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[2179    0]
 [   0 4114]]
2017-09-07 11:04:38,753 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:04:38,753 [MainThread  ] [INFO ]  [[2179    0]
 [   0 4114]]
2017-09-07 11:04:39,152 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:04:39,152 [MainThread  ] [INFO ]  [[ 1.  0.]
 [ 0.  1.]]
2017-09-07 11:04:39,347 [MainThread  ] [INFO ]  ================ Evaluation metrics for model gbm [Dataset is train]=======================
2017-09-07 11:04:39,347 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:04:39,349 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:39,349 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:04:39,352 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:39,352 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:04:39,355 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:39,355 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:04:39,359 [MainThread  ] [INFO ]  1.0
2017-09-07 11:04:39,359 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:04:39,594 [MainThread  ] [INFO ]  training complete...
2017-09-07 11:04:39,595 [MainThread  ] [INFO ]  evaluate the models on the test data
2017-09-07 11:04:39,634 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      619          275       226              428      805    1264   
top     Drug019       DSC016     DC016           DCN024  DGPI003  NDC026   
freq         92          217       217              125       81      78   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        76       675    88      166      47      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         494       220   667      506     661   2061  
2017-09-07 11:04:39,651 [MainThread  ] [INFO ]  drug                object
drugsubclass        object
drugclass           object
drugchemicalname    object
gpi                 object
ndc                 object
druggroup           object
rxgroupid           object
bin                 object
pcn                 object
state               object
target              object
dtype: object
2017-09-07 11:04:39,670 [MainThread  ] [INFO ]  Pre-processed data frame :: 
2017-09-07 11:04:39,711 [MainThread  ] [INFO ]             drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      619          275       226              428      805    1264   
top     Drug019       DSC016     DC016           DCN024  DGPI003  NDC026   
freq         92          217       217              125       81      78   

       druggroup rxgroupid   bin      pcn   state target  
count       3101      3101  3101     3101    3101   3101  
unique        76       675    88      166      47      2  
top        DG004      G060  B003  PCN0005  State2   TRUE  
freq         494       220   667      506     661   2061  
2017-09-07 11:04:39,725 [MainThread  ] [INFO ]  drug                category
drugsubclass        category
drugclass           category
drugchemicalname    category
gpi                 category
ndc                 category
druggroup           category
rxgroupid           category
bin                 category
pcn                 category
state               category
target              category
dtype: object
2017-09-07 11:04:39,739 [MainThread  ] [INFO ]  feature_frame_train is  ::            drug target
count      3101   3101
unique      619      2
top     Drug019   TRUE
freq         92   2061
2017-09-07 11:04:41,079 [MainThread  ] [INFO ]  {4: 2968.0}
2017-09-07 11:04:41,237 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugsubclass target
count          3101   3101
unique          275      2
top          DSC016   TRUE
freq            217   2061
2017-09-07 11:04:44,336 [MainThread  ] [INFO ]  {4: 2733.0}
2017-09-07 11:04:44,481 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugclass target
count       3101   3101
unique       226      2
top        DC016   TRUE
freq         217   2061
2017-09-07 11:04:45,797 [MainThread  ] [INFO ]  {4: 2809.0}
2017-09-07 11:04:45,947 [MainThread  ] [INFO ]  feature_frame_train is  ::        drugchemicalname target
count              3101   3101
unique              428      2
top              DCN024   TRUE
freq                125   2061
2017-09-07 11:04:48,500 [MainThread  ] [INFO ]  {4: 2885.0}
2017-09-07 11:04:48,649 [MainThread  ] [INFO ]  feature_frame_train is  ::             gpi target
count      3101   3101
unique      805      2
top     DGPI003   TRUE
freq         81   2061
2017-09-07 11:04:51,352 [MainThread  ] [INFO ]  {4: 2957.0}
2017-09-07 11:04:51,527 [MainThread  ] [INFO ]  feature_frame_train is  ::            ndc target
count     3101   3101
unique    1264      2
top     NDC026   TRUE
freq        78   2061
2017-09-07 11:04:52,454 [MainThread  ] [INFO ]  {4: 3001.0}
2017-09-07 11:04:52,612 [MainThread  ] [INFO ]  feature_frame_train is  ::        druggroup target
count       3101   3101
unique        76      2
top        DG004   TRUE
freq         494   2061
2017-09-07 11:04:53,978 [MainThread  ] [INFO ]  {4: 2453.0}
2017-09-07 11:04:54,123 [MainThread  ] [INFO ]  feature_frame_train is  ::        rxgroupid target
count       3101   3101
unique       675      2
top         G060   TRUE
freq         220   2061
2017-09-07 11:04:56,409 [MainThread  ] [INFO ]  {4: 2749.0}
2017-09-07 11:04:56,646 [MainThread  ] [INFO ]  feature_frame_train is  ::          bin target
count   3101   3101
unique    88      2
top     B003   TRUE
freq     667   2061
2017-09-07 11:04:58,190 [MainThread  ] [INFO ]  {4: 2193.0}
2017-09-07 11:04:58,333 [MainThread  ] [INFO ]  feature_frame_train is  ::             pcn target
count      3101   3101
unique      166      2
top     PCN0005   TRUE
freq        506   2061
2017-09-07 11:04:59,981 [MainThread  ] [INFO ]  {4: 2280.0}
2017-09-07 11:05:00,138 [MainThread  ] [INFO ]  feature_frame_train is  ::          state target
count     3101   3101
unique      47      2
top     State2   TRUE
freq       661   2061
2017-09-07 11:05:01,150 [MainThread  ] [INFO ]  {4: 1981.0}
2017-09-07 11:05:01,386 [MainThread  ] [INFO ]  updated_df ::            drug drugsubclass drugclass drugchemicalname      gpi     ndc  \
count      3101         3101      3101             3101     3101    3101   
unique      619          275       226              428      805    1264   
top     Drug019       DSC016     DC016           DCN024  DGPI003  NDC026   
freq         92          217       217              125       81      78   

       druggroup rxgroupid   bin      pcn        ...          \
count       3101      3101  3101     3101        ...           
unique        76       675    88      166        ...           
top        DG004      G060  B003  PCN0005        ...           
freq         494       220   667      506        ...           

       drugsubclass_cluster_num drugclass_cluster_num  \
count                      3101                  3101   
unique                        4                     4   
top                           1                     0   
freq                       1847                  2080   

        drugchemicalname_cluster_num  gpi_cluster_num  ndc_cluster_num  \
count                           3101             3101             3101   
unique                             4                4                4   
top                                1                1                1   
freq                            1948             1962             2022   

        druggroup_cluster_num  rxgroupid_cluster_num  bin_cluster_num  \
count                    3101                   3101             3101   
unique                      4                      4                4   
top                         0                      1                1   
freq                     1798                   1856             1620   

        pcn_cluster_num  state_cluster_num  
count              3101               3101  
unique                4                  4  
top                   2                  0  
freq               1422               1334  

[4 rows x 23 columns]
2017-09-07 11:05:01,427 [MainThread  ] [INFO ]  test data pre-processed describe ::         target  drug_cluster_num  drugsubclass_cluster_num  \
count     3101              3101                      3101   
unique       2                 4                         4   
top          1                 1                         1   
freq      2061              2020                      1847   

        drugclass_cluster_num  drugchemicalname_cluster_num  gpi_cluster_num  \
count                    3101                          3101             3101   
unique                      4                             4                4   
top                         0                             1                1   
freq                     2080                          1948             1962   

        ndc_cluster_num  druggroup_cluster_num  rxgroupid_cluster_num  \
count              3101                   3101                   3101   
unique                4                      4                      4   
top                   1                      0                      1   
freq               2022                   1798                   1856   

        bin_cluster_num  pcn_cluster_num  state_cluster_num  
count              3101             3101               3101  
unique                4                4                  4  
top                   1                2                  0  
freq               1620             1422               1334  
2017-09-07 11:05:01,440 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
6293                   0                   0                   1   
6294                   0                   1                   0   
6295                   1                   0                   0   
6296                   0                   1                   0   
6297                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
6293                   0                           0   
6294                   0                           0   
6295                   0                           1   
6296                   0                           0   
6297                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
6293                           1                           0   
6294                           1                           0   
6295                           0                           0   
6296                           1                           0   
6297                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
6293                           0                        0   
6294                           0                        1   
6295                           0                        0   
6296                           0                        1   
6297                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
6293                        0         ...                           0   
6294                        0         ...                           0   
6295                        1         ...                           0   
6296                        0         ...                           0   
6297                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
6293                  0                  0                  0   
6294                  1                  1                  0   
6295                  0                  1                  0   
6296                  0                  0                  0   
6297                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
6293                  1                  0                    0   
6294                  0                  0                    0   
6295                  0                  0                    0   
6296                  0                  1                    1   
6297                  0                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
6293                    0                    1                    0  
6294                    1                    0                    0  
6295                    1                    0                    0  
6296                    0                    0                    0  
6297                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 11:05:01,462 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_naive_bayes.sav
2017-09-07 11:05:01,463 [MainThread  ] [INFO ]  loaded model is :: MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
2017-09-07 11:05:01,464 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 1 1]
2017-09-07 11:05:01,466 [MainThread  ] [INFO ]  y_pred probabilities is :: [  3.69170727e-05   1.00000000e+00   8.00339025e-05 ...,   8.00339025e-05
   9.99999987e-01   9.99931919e-01]
2017-09-07 11:05:01,828 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 495  545]
 [  24 2037]]
2017-09-07 11:05:01,986 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:05:01,987 [MainThread  ] [INFO ]  [[ 495  545]
 [  24 2037]]
2017-09-07 11:05:02,610 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:05:02,611 [MainThread  ] [INFO ]  [[ 0.47596154  0.52403846]
 [ 0.01164483  0.98835517]]
2017-09-07 11:05:02,946 [MainThread  ] [INFO ]  ================ Evaluation metrics for model naive_bayes [Dataset is test]=======================
2017-09-07 11:05:02,946 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:05:02,949 [MainThread  ] [INFO ]  0.816510802967
2017-09-07 11:05:02,949 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:05:02,951 [MainThread  ] [INFO ]  0.988355167394
2017-09-07 11:05:02,951 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:05:02,953 [MainThread  ] [INFO ]  0.788923315259
2017-09-07 11:05:02,953 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:05:02,955 [MainThread  ] [INFO ]  0.877449924618
2017-09-07 11:05:02,955 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:05:03,337 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
6293                   0                   0                   1   
6294                   0                   1                   0   
6295                   1                   0                   0   
6296                   0                   1                   0   
6297                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
6293                   0                           0   
6294                   0                           0   
6295                   0                           1   
6296                   0                           0   
6297                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
6293                           1                           0   
6294                           1                           0   
6295                           0                           0   
6296                           1                           0   
6297                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
6293                           0                        0   
6294                           0                        1   
6295                           0                        0   
6296                           0                        1   
6297                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
6293                        0         ...                           0   
6294                        0         ...                           0   
6295                        1         ...                           0   
6296                        0         ...                           0   
6297                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
6293                  0                  0                  0   
6294                  1                  1                  0   
6295                  0                  1                  0   
6296                  0                  0                  0   
6297                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
6293                  1                  0                    0   
6294                  0                  0                    0   
6295                  0                  0                    0   
6296                  0                  1                    1   
6297                  0                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
6293                    0                    1                    0  
6294                    1                    0                    0  
6295                    1                    0                    0  
6296                    0                    0                    0  
6297                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 11:05:03,363 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_random_forest.sav
2017-09-07 11:05:03,372 [MainThread  ] [INFO ]  loaded model is :: RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
2017-09-07 11:05:03,407 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 1 1]
2017-09-07 11:05:03,443 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.47  0.56  0.41 ...,  0.41  0.58  0.52]
2017-09-07 11:05:03,794 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 999   41]
 [  28 2033]]
2017-09-07 11:05:03,954 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:05:03,955 [MainThread  ] [INFO ]  [[ 999   41]
 [  28 2033]]
2017-09-07 11:05:04,324 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:05:04,325 [MainThread  ] [INFO ]  [[ 0.96057692  0.03942308]
 [ 0.01358564  0.98641436]]
2017-09-07 11:05:04,614 [MainThread  ] [INFO ]  ================ Evaluation metrics for model random_forest [Dataset is test]=======================
2017-09-07 11:05:04,615 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:05:04,616 [MainThread  ] [INFO ]  0.977749113189
2017-09-07 11:05:04,616 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:05:04,619 [MainThread  ] [INFO ]  0.98641436196
2017-09-07 11:05:04,619 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:05:04,622 [MainThread  ] [INFO ]  0.980231436837
2017-09-07 11:05:04,622 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:05:04,624 [MainThread  ] [INFO ]  0.983313180169
2017-09-07 11:05:04,624 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:05:04,879 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
6293                   0                   0                   1   
6294                   0                   1                   0   
6295                   1                   0                   0   
6296                   0                   1                   0   
6297                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
6293                   0                           0   
6294                   0                           0   
6295                   0                           1   
6296                   0                           0   
6297                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
6293                           1                           0   
6294                           1                           0   
6295                           0                           0   
6296                           1                           0   
6297                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
6293                           0                        0   
6294                           0                        1   
6295                           0                        0   
6296                           0                        1   
6297                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
6293                        0         ...                           0   
6294                        0         ...                           0   
6295                        1         ...                           0   
6296                        0         ...                           0   
6297                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
6293                  0                  0                  0   
6294                  1                  1                  0   
6295                  0                  1                  0   
6296                  0                  0                  0   
6297                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
6293                  1                  0                    0   
6294                  0                  0                    0   
6295                  0                  0                    0   
6296                  0                  1                    1   
6297                  0                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
6293                    0                    1                    0  
6294                    1                    0                    0  
6295                    1                    0                    0  
6296                    0                    0                    0  
6297                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 11:05:04,902 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_neural_net.sav
2017-09-07 11:05:04,903 [MainThread  ] [INFO ]  loaded model is :: MLPClassifier(activation='relu', alpha=1e-05, batch_size='auto', beta_1=0.9,
       beta_2=0.999, early_stopping=False, epsilon=1e-08,
       hidden_layer_sizes=(5, 2), learning_rate='constant',
       learning_rate_init=0.001, max_iter=200, momentum=0.9,
       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,
       solver='lbfgs', tol=0.0001, validation_fraction=0.1, verbose=False,
       warm_start=False)
2017-09-07 11:05:04,926 [MainThread  ] [INFO ]  y_pred is :: [1 1 0 ..., 0 1 1]
2017-09-07 11:05:04,928 [MainThread  ] [INFO ]  y_pred probabilities is :: [  9.99929930e-01   9.99999983e-01   1.87566695e-04 ...,   1.87566695e-04
   9.99974409e-01   9.99999970e-01]
2017-09-07 11:05:05,274 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[1040    0]
 [   1 2060]]
2017-09-07 11:05:05,398 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:05:05,398 [MainThread  ] [INFO ]  [[1040    0]
 [   1 2060]]
2017-09-07 11:05:05,735 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:05:05,736 [MainThread  ] [INFO ]  [[  1.00000000e+00   0.00000000e+00]
 [  4.85201359e-04   9.99514799e-01]]
2017-09-07 11:05:05,933 [MainThread  ] [INFO ]  ================ Evaluation metrics for model neural_net [Dataset is test]=======================
2017-09-07 11:05:05,933 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:05:05,935 [MainThread  ] [INFO ]  0.99967752338
2017-09-07 11:05:05,935 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:05:05,937 [MainThread  ] [INFO ]  0.999514798641
2017-09-07 11:05:05,937 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:05:05,940 [MainThread  ] [INFO ]  1.0
2017-09-07 11:05:05,941 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:05:05,943 [MainThread  ] [INFO ]  0.999757340451
2017-09-07 11:05:05,943 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:05:06,197 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
6293                   0                   0                   1   
6294                   0                   1                   0   
6295                   1                   0                   0   
6296                   0                   1                   0   
6297                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
6293                   0                           0   
6294                   0                           0   
6295                   0                           1   
6296                   0                           0   
6297                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
6293                           1                           0   
6294                           1                           0   
6295                           0                           0   
6296                           1                           0   
6297                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
6293                           0                        0   
6294                           0                        1   
6295                           0                        0   
6296                           0                        1   
6297                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
6293                        0         ...                           0   
6294                        0         ...                           0   
6295                        1         ...                           0   
6296                        0         ...                           0   
6297                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
6293                  0                  0                  0   
6294                  1                  1                  0   
6295                  0                  1                  0   
6296                  0                  0                  0   
6297                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
6293                  1                  0                    0   
6294                  0                  0                    0   
6295                  0                  0                    0   
6296                  0                  1                    1   
6297                  0                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
6293                    0                    1                    0  
6294                    1                    0                    0  
6295                    1                    0                    0  
6296                    0                    0                    0  
6297                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 11:05:06,219 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_svm.sav
2017-09-07 11:05:06,219 [MainThread  ] [INFO ]  loaded model is :: SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=True, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
2017-09-07 11:05:06,227 [MainThread  ] [INFO ]  y_pred is :: [0 1 0 ..., 0 1 1]
2017-09-07 11:05:06,237 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.39037453  0.93105149  0.28712171 ...,  0.28712171  0.81809595
  0.78288894]
2017-09-07 11:05:06,556 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[ 905  135]
 [   6 2055]]
2017-09-07 11:05:06,680 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:05:06,680 [MainThread  ] [INFO ]  [[ 905  135]
 [   6 2055]]
2017-09-07 11:05:07,020 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:05:07,020 [MainThread  ] [INFO ]  [[ 0.87019231  0.12980769]
 [ 0.00291121  0.99708879]]
2017-09-07 11:05:07,314 [MainThread  ] [INFO ]  ================ Evaluation metrics for model svm [Dataset is test]=======================
2017-09-07 11:05:07,315 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:05:07,316 [MainThread  ] [INFO ]  0.954530796517
2017-09-07 11:05:07,316 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:05:07,317 [MainThread  ] [INFO ]  0.997088791849
2017-09-07 11:05:07,317 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:05:07,319 [MainThread  ] [INFO ]  0.938356164384
2017-09-07 11:05:07,319 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:05:07,321 [MainThread  ] [INFO ]  0.966831333804
2017-09-07 11:05:07,321 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:05:07,592 [MainThread  ] [INFO ]        drug_cluster_num_0  drug_cluster_num_1  drug_cluster_num_2  \
6293                   0                   0                   1   
6294                   0                   1                   0   
6295                   1                   0                   0   
6296                   0                   1                   0   
6297                   1                   0                   0   

      drug_cluster_num_3  drugsubclass_cluster_num_0  \
6293                   0                           0   
6294                   0                           0   
6295                   0                           1   
6296                   0                           0   
6297                   0                           1   

      drugsubclass_cluster_num_1  drugsubclass_cluster_num_2  \
6293                           1                           0   
6294                           1                           0   
6295                           0                           0   
6296                           1                           0   
6297                           0                           0   

      drugsubclass_cluster_num_3  drugclass_cluster_num_0  \
6293                           0                        0   
6294                           0                        1   
6295                           0                        0   
6296                           0                        1   
6297                           0                        0   

      drugclass_cluster_num_1         ...           bin_cluster_num_2  \
6293                        0         ...                           0   
6294                        0         ...                           0   
6295                        1         ...                           0   
6296                        0         ...                           0   
6297                        1         ...                           0   

      bin_cluster_num_3  pcn_cluster_num_0  pcn_cluster_num_1  \
6293                  0                  0                  0   
6294                  1                  1                  0   
6295                  0                  1                  0   
6296                  0                  0                  0   
6297                  0                  1                  0   

      pcn_cluster_num_2  pcn_cluster_num_3  state_cluster_num_0  \
6293                  1                  0                    0   
6294                  0                  0                    0   
6295                  0                  0                    0   
6296                  0                  1                    1   
6297                  0                  0                    0   

      state_cluster_num_1  state_cluster_num_2  state_cluster_num_3  
6293                    0                    1                    0  
6294                    1                    0                    0  
6295                    1                    0                    0  
6296                    0                    0                    0  
6297                    1                    0                    0  

[5 rows x 44 columns]
2017-09-07 11:05:07,615 [MainThread  ] [INFO ]  model file path is :: ../models/preprocess2/model_gbm.sav
2017-09-07 11:05:07,657 [MainThread  ] [INFO ]  loaded model is :: GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.01, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=1200,
              presort='auto', random_state=3, subsample=0.5, verbose=0,
              warm_start=False)
2017-09-07 11:05:07,685 [MainThread  ] [INFO ]  y_pred is :: [0 0 1 ..., 1 0 0]
2017-09-07 11:05:07,715 [MainThread  ] [INFO ]  y_pred probabilities is :: [ 0.48221225  0.4812999   0.66278022 ...,  0.66278022  0.48302947
  0.48246461]
2017-09-07 11:05:08,046 [MainThread  ] [INFO ]  Confusion Matrix for model is :: [[  33 1007]
 [1747  314]]
2017-09-07 11:05:08,179 [MainThread  ] [INFO ]  Confusion matrix, without normalization
2017-09-07 11:05:08,179 [MainThread  ] [INFO ]  [[  33 1007]
 [1747  314]]
2017-09-07 11:05:08,671 [MainThread  ] [INFO ]  Normalized confusion matrix
2017-09-07 11:05:08,672 [MainThread  ] [INFO ]  [[ 0.03173077  0.96826923]
 [ 0.84764677  0.15235323]]
2017-09-07 11:05:08,869 [MainThread  ] [INFO ]  ================ Evaluation metrics for model gbm [Dataset is test]=======================
2017-09-07 11:05:08,870 [MainThread  ] [INFO ]  Accuracy of model is ::
2017-09-07 11:05:08,871 [MainThread  ] [INFO ]  0.111899387294
2017-09-07 11:05:08,871 [MainThread  ] [INFO ]  Recall of model is ::
2017-09-07 11:05:08,872 [MainThread  ] [INFO ]  0.152353226589
2017-09-07 11:05:08,873 [MainThread  ] [INFO ]  Precision score of model is ::
2017-09-07 11:05:08,874 [MainThread  ] [INFO ]  0.237698713096
2017-09-07 11:05:08,874 [MainThread  ] [INFO ]  F1 score of model is ::
2017-09-07 11:05:08,876 [MainThread  ] [INFO ]  0.185688941455
2017-09-07 11:05:08,876 [MainThread  ] [INFO ]  Do ROC Analysis..
2017-09-07 11:05:09,124 [MainThread  ] [INFO ]  testing complete...
